<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>A Living Card For You</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;1,300;1,400&family=Nunito+Sans:wght@300;400&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Nunito Sans',sans-serif;overflow:hidden;width:100vw;height:100vh;touch-action:manipulation;-webkit-font-smoothing:antialiased;background:#06081A}canvas{position:fixed;inset:0;z-index:0}
.envelope-screen{position:fixed;inset:0;z-index:100;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#06081A;cursor:pointer;transition:opacity 1.4s cubic-bezier(.4,0,.2,1),transform 1.4s cubic-bezier(.4,0,.2,1)}.envelope-screen.opened{opacity:0;transform:scale(1.15);pointer-events:none}
.env-wrap{position:relative;width:160px;height:130px}.env-body{width:160px;height:100px;background:linear-gradient(145deg,#141830,#0E1225);border-radius:5px;position:absolute;bottom:0;box-shadow:0 10px 50px rgba(0,0,0,.4);border:1px solid rgba(140,200,230,.05)}.env-flap{width:0;height:0;border-left:80px solid transparent;border-right:80px solid transparent;border-top:65px solid #1A2040;position:absolute;top:0;transition:transform 1s cubic-bezier(.4,0,.2,1);transform-origin:top center}.envelope-screen:hover .env-flap{transform:rotateX(50deg)}
.env-seal{width:30px;height:30px;border-radius:50%;background:linear-gradient(135deg,#80D0E8,#60A8C8);position:absolute;top:38px;left:50%;transform:translateX(-50%);z-index:2;box-shadow:0 3px 22px rgba(96,168,200,.4);display:flex;align-items:center;justify-content:center;font-size:.7rem;color:#06081A;animation:seal 4s ease-in-out infinite}@keyframes seal{0%,100%{transform:translateX(-50%) scale(1)}50%{transform:translateX(-50%) scale(1.1)}}
.env-hint{margin-top:2.5rem;font-family:'Cormorant Garamond',serif;font-style:italic;font-size:1.05rem;color:#5A7A8A;opacity:0;animation:fi 2s ease 1s forwards}.env-from{margin-top:.8rem;font-family:'Cormorant Garamond',serif;font-size:.85rem;letter-spacing:.1em;color:#80C8E0;opacity:0;animation:fi 2s ease 1.5s forwards}@keyframes fi{to{opacity:.7}}
.card-exp{position:fixed;inset:0;z-index:10;display:flex;flex-direction:column;align-items:center;justify-content:center;opacity:0;transition:opacity 1.8s ease .6s;pointer-events:none;padding:2rem}.card-exp.active{opacity:1;pointer-events:auto}
.photo-frame{position:relative;width:min(280px,75vw);height:min(280px,75vw);border-radius:22px;overflow:hidden;cursor:pointer;box-shadow:0 20px 80px rgba(0,0,0,.35),0 0 40px rgba(128,200,230,.04);transition:transform .6s;margin-bottom:2rem;opacity:0;transform:translateY(25px);animation:rev 1.6s ease 1.8s forwards}@keyframes rev{to{opacity:1;transform:translateY(0)}}.photo-frame:hover{transform:scale(1.02)}.photo-canvas{width:100%;height:100%;display:block}
.filter-label{position:absolute;bottom:12px;left:50%;transform:translateX(-50%);font-family:'Cormorant Garamond',serif;font-style:italic;font-size:.8rem;color:#C0E0F0;background:rgba(6,8,26,.55);backdrop-filter:blur(10px);padding:5px 18px;border-radius:20px;pointer-events:none}.tap-hint{position:absolute;top:12px;right:12px;font-size:.6rem;color:#C0E0F0;background:rgba(6,8,26,.45);backdrop-filter:blur(8px);padding:3px 10px;border-radius:12px;opacity:0;animation:fi 1.5s ease 3.5s forwards}
.msg{text-align:center;max-width:420px;opacity:0;transform:translateY(25px);animation:rev 1.6s ease 2.6s forwards}.msg-occ{font-size:.65rem;font-weight:600;letter-spacing:.25em;text-transform:uppercase;color:#80C8E0;margin-bottom:.8rem}.msg-div{display:block;width:45px;height:1px;background:linear-gradient(to right,transparent,#80C8E0,transparent);margin:0 auto 1rem}.msg-txt{font-family:'Cormorant Garamond',serif;font-weight:300;font-size:clamp(1.15rem,3.8vw,1.75rem);line-height:1.65;color:#C0E0F0;margin-bottom:1.5rem}.msg-from{font-family:'Cormorant Garamond',serif;font-style:italic;font-size:1.05rem;color:#60A8C8}
.branding{position:fixed;bottom:1.5rem;left:50%;transform:translateX(-50%);z-index:20;font-family:'Cormorant Garamond',serif;font-size:.72rem;color:rgba(96,168,200,.3);opacity:0;letter-spacing:.08em;animation:fi 2s ease 4s forwards}.branding a{color:#80C8E0;text-decoration:none}
@media(max-height:700px){.photo-frame{width:min(200px,55vw);height:min(200px,55vw)}}
</style>
</head>
<body>
<canvas id="c"></canvas>
<div class="envelope-screen" id="env"><div class="env-wrap"><div class="env-flap"></div><div class="env-body"></div><div class="env-seal">✉</div></div><p class="env-hint">tap to open</p><p class="env-from">a message in a bottle — just for you</p></div>
<div class="card-exp" id="exp"><div class="photo-frame" id="pf"><canvas class="photo-canvas" id="pc"></canvas><div class="filter-label" id="fl">Original</div><div class="tap-hint">tap to transform</div></div><div class="msg"><p class="msg-occ">Sending You Hope</p><span class="msg-div"></span><p class="msg-txt">I put every good thing I could think of into this — every prayer, every hope, every quiet wish at 11:11. It's all in there. It's all for you.</p><p class="msg-from">— always reaching for you</p></div></div>
<div class="branding">made with <a href="#">LiveCardStudio</a> — cards that breathe</div>
<script>
const P=new Uint8Array(512),G=[];(function(){const p=[];for(let i=0;i<256;i++)p[i]=i;for(let i=255;i>0;i--){const j=Math.floor(Math.random()*(i+1));[p[i],p[j]]=[p[j],p[i]];}for(let i=0;i<512;i++)P[i]=p[i&255];for(let i=0;i<256;i++){const a=Math.random()*Math.PI*2;G[i]=[Math.cos(a),Math.sin(a)];}})();
function fade(t){return t*t*t*(t*(t*6-15)+10)}function lerp(a,b,t){return a+(b-a)*t}function dot2(g,x,y){return g[0]*x+g[1]*y}
function noise2D(x,y){const X=Math.floor(x)&255,Y=Math.floor(y)&255,xf=x-Math.floor(x),yf=y-Math.floor(y),u=fade(xf),v=fade(yf);return lerp(lerp(dot2(G[P[P[X]+Y]],xf,yf),dot2(G[P[P[X+1]+Y]],xf-1,yf),u),lerp(dot2(G[P[P[X]+Y+1]],xf,yf-1),dot2(G[P[P[X+1]+Y+1]],xf-1,yf-1),u),v)}

const canvas=document.getElementById('c'),ctx=canvas.getContext('2d');let W,H,t=0,mx=0,my=0,mxS=0,myS=0;
function resize(){W=canvas.width=innerWidth;H=canvas.height=innerHeight}resize();addEventListener('resize',resize);
addEventListener('mousemove',e=>{mx=e.clientX;my=e.clientY});addEventListener('touchmove',e=>{mx=e.touches[0].clientX;my=e.touches[0].clientY},{passive:true});

const boundary=H*.5; // Water-sky boundary

// ═══ BACKGROUND ═══
function drawBG(t){
  const b=Math.sin(t*.00015)*.02;
  const g=ctx.createLinearGradient(0,0,0,H);
  // Sky portion
  g.addColorStop(0,`hsl(230,30%,${6+b*100}%)`);g.addColorStop(.15,'hsl(235,25%,9%)');g.addColorStop(.35,'hsl(240,22%,12%)');
  // Boundary zone
  g.addColorStop(.48,'hsl(210,25%,16%)');g.addColorStop(.52,'hsl(200,30%,14%)');
  // Water portion
  g.addColorStop(.65,'hsl(210,28%,10%)');g.addColorStop(.8,'hsl(215,30%,7%)');g.addColorStop(1,'hsl(220,35%,4%)');
  ctx.fillStyle=g;ctx.fillRect(0,0,W,H);
}

// ═══ BOUNDARY MIST ═══
function drawBoundaryMist(t){
  ctx.save();
  for(let i=0;i<5;i++){
    const x=W*(.1+i*.2)+noise2D(i*10+t*.00005,0)*60;
    const y=boundary+noise2D(0,i*10+t*.00004)*15;
    const rw=80+Math.random()*120;
    const breathe=.7+Math.sin(t*.0003+i*2)*.3;
    const g=ctx.createRadialGradient(x,y,0,x,y,rw*breathe);
    g.addColorStop(0,'rgba(100,140,170,.02)');g.addColorStop(1,'rgba(100,140,170,0)');
    ctx.fillStyle=g;ctx.save();ctx.scale(1,.2);ctx.beginPath();ctx.arc(x,y*5,rw*breathe,0,Math.PI*2);ctx.fill();ctx.restore();
  }
  ctx.restore();
}

// ═══ STARS (above boundary) ═══
class Star{constructor(){this.x=Math.random()*W;this.y=Math.random()*boundary*.9;this.sz=.3+Math.random()*1;this.al=.06+Math.random()*.18;this.twSp=.002+Math.random()*.005;this.ph=Math.random()*Math.PI*2}draw(t){const tw=.3+Math.sin(t*this.twSp+this.ph)*.7;ctx.globalAlpha=this.al*tw;ctx.fillStyle='rgba(200,210,240,.9)';ctx.beginPath();ctx.arc(this.x,this.y,this.sz,0,Math.PI*2);ctx.fill();ctx.globalAlpha=1}}

// ═══ CAUSTICS (below boundary) ═══
function drawCaustics(t){
  ctx.save();ctx.globalAlpha=.01;ctx.globalCompositeOperation='screen';
  for(let i=0;i<5;i++){
    const x=W*(.1+Math.random()*.8)+noise2D(i*8+t*.00008,0)*60;
    const y=boundary+30+Math.random()*(H-boundary-60)+noise2D(0,i*8+t*.00006)*30;
    const r=30+Math.random()*60;
    const pulse=.5+Math.sin(t*.001+i*2.5)*.5;
    const g=ctx.createRadialGradient(x,y,0,x,y,r);
    g.addColorStop(0,`rgba(80,180,220,${.06*pulse})`);g.addColorStop(1,'rgba(80,180,220,0)');
    ctx.fillStyle=g;ctx.beginPath();ctx.arc(x,y,r,0,Math.PI*2);ctx.fill();
  }
  ctx.restore();
}

// ═══ WISH BOTTLE ═══
class WishBottle{
  constructor(dp){this.dp=dp;this.sc=[.35,.6,1][dp];this.aBase=[.06,.15,.3][dp];this.reset(true)}
  reset(init){
    this.x=Math.random()*W;
    this.y=init?boundary+Math.random()*(H-boundary)*.6:H+30+Math.random()*60;
    this.sz=(8+Math.random()*6)*this.sc;
    this.vy=-(0.1+Math.random()*.2)*this.sc;
    this.vx=(Math.random()-.5)*.1;
    this.alpha=this.aBase;
    this.no=Math.random()*200;
    this.bobPh=Math.random()*Math.PI*2;
    this.bobSp=.006+Math.random()*.01;
    this.rot=0;
    this.rotTarget=(Math.random()-.5)*.3;
    this.hue=180+Math.random()*40;
    this.warmHue=30+Math.random()*15;
    this.flickerPh=Math.random()*Math.PI*2;
    this.flickerSp=.015+Math.random()*.02;
    this.bubbles=[];
    this.bubbleTimer=0;
    this.crossedBoundary=false;
  }
  update(t){
    const drift=noise2D(this.no+t*.0002,this.y*.003)*.15;
    this.vx+=drift*.003*this.sc;this.vx*=.995;
    this.vy+=-0.0003*this.sc; // slight acceleration upward
    this.x+=this.vx;
    this.y+=this.vy+Math.sin(t*this.bobSp+this.bobPh)*.05*this.sc;
    this.rot+=(this.rotTarget-this.rot)*.002;
    this.rotTarget=noise2D(this.no+t*.0001,0)*.25;
    
    // Crossing boundary
    if(!this.crossedBoundary&&this.y<boundary){this.crossedBoundary=true;}
    
    // Spawn bubbles/sparkles
    this.bubbleTimer++;
    if(this.bubbleTimer>6+Math.random()*12){
      const inWater=this.y>boundary;
      this.bubbles.push({
        x:this.x+(Math.random()-.5)*this.sz,
        y:this.y+this.sz*.5,
        vy:inWater?-(0.1+Math.random()*.3):(0.05+Math.random()*.15),
        vx:(Math.random()-.5)*.15,
        a:inWater?.1+Math.random()*.1:.08+Math.random()*.12,
        sz:inWater?(.3+Math.random()*.8)*this.sc:(.2+Math.random()*.5)*this.sc,
        isSpark:!inWater,
        hue:inWater?this.hue:this.warmHue+Math.random()*20,
      });
      this.bubbleTimer=0;
    }
    this.bubbles.forEach(b=>{b.x+=b.vx+noise2D(b.x*.01+t*.001,b.y*.01)*.05;b.y+=b.vy;b.a*=.99;});
    this.bubbles=this.bubbles.filter(b=>b.a>.005);
    
    if(this.y<-60)this.reset(false);
  }
  draw(t){
    const flicker=.65+Math.sin(t*this.flickerSp+this.flickerPh)*.35;
    const inWater=this.y>boundary;
    
    ctx.save();
    
    // Bubbles/sparkles
    this.bubbles.forEach(b=>{
      ctx.globalAlpha=b.a;
      if(b.isSpark){
        // Sparkle in air
        ctx.fillStyle=`hsla(${b.hue},45%,75%,.6)`;
        ctx.beginPath();ctx.arc(b.x,b.y,b.sz,0,Math.PI*2);ctx.fill();
        if(b.a>.05){const sg=ctx.createRadialGradient(b.x,b.y,0,b.x,b.y,b.sz*4);sg.addColorStop(0,`hsla(${b.hue},40%,65%,.04)`);sg.addColorStop(1,'transparent');ctx.fillStyle=sg;ctx.beginPath();ctx.arc(b.x,b.y,b.sz*4,0,Math.PI*2);ctx.fill();}
      } else {
        // Bubble in water
        ctx.strokeStyle=`rgba(140,200,230,${b.a*.5})`;ctx.lineWidth=.3;ctx.beginPath();ctx.arc(b.x,b.y,b.sz,0,Math.PI*2);ctx.stroke();
        ctx.fillStyle=`rgba(180,220,240,${b.a*.2})`;ctx.beginPath();ctx.arc(b.x-b.sz*.2,b.y-b.sz*.2,b.sz*.2,0,Math.PI*2);ctx.fill();
      }
    });
    
    ctx.globalAlpha=this.alpha;
    ctx.translate(this.x,this.y);ctx.rotate(this.rot);
    
    // Glow halo
    const gr=this.sz*6*flicker;
    const hue=inWater?this.hue:this.warmHue;
    const og=ctx.createRadialGradient(0,0,0,0,0,gr);
    og.addColorStop(0,`hsla(${hue},45%,55%,${.05*flicker})`);
    og.addColorStop(.3,`hsla(${hue},40%,50%,${.02*flicker})`);
    og.addColorStop(1,`hsla(${hue},35%,45%,0)`);
    ctx.fillStyle=og;ctx.beginPath();ctx.arc(0,0,gr,0,Math.PI*2);ctx.fill();
    
    // Bottle body
    const bw=this.sz*.5,bh=this.sz*1.2;
    // Glass body
    ctx.strokeStyle=`hsla(${hue},25%,60%,${.12+flicker*.04})`;
    ctx.lineWidth=.6*this.sc;
    ctx.beginPath();
    ctx.moveTo(-bw,bh*.1); // left shoulder
    ctx.quadraticCurveTo(-bw,bh*.5,-bw*.8,bh*.5); // left bottom curve
    ctx.lineTo(bw*.8,bh*.5); // bottom
    ctx.quadraticCurveTo(bw,bh*.5,bw,bh*.1); // right bottom curve
    ctx.lineTo(bw*.4,-bh*.2); // right neck taper
    ctx.lineTo(bw*.35,-bh*.5); // right neck
    ctx.lineTo(-bw*.35,-bh*.5); // left neck
    ctx.lineTo(-bw*.4,-bh*.2); // left neck taper
    ctx.closePath();ctx.stroke();
    
    // Glass fill (subtle)
    ctx.fillStyle=`hsla(${hue},20%,50%,${.03+flicker*.01})`;ctx.fill();
    
    // Cork
    ctx.fillStyle=`hsla(30,25%,40%,${.08})`;
    ctx.fillRect(-bw*.3,-bh*.58,bw*.6,bh*.12);
    
    // Inner warm light
    const ig=ctx.createRadialGradient(0,bh*.15,0,0,bh*.1,bw*.8);
    ig.addColorStop(0,`hsla(${this.warmHue},55%,65%,${.15*flicker})`);
    ig.addColorStop(.5,`hsla(${this.warmHue},50%,55%,${.05*flicker})`);
    ig.addColorStop(1,'transparent');
    ctx.fillStyle=ig;ctx.beginPath();ctx.arc(0,bh*.1,bw*.8,0,Math.PI*2);ctx.fill();
    
    // Tiny scroll/paper inside
    ctx.fillStyle=`hsla(40,20%,80%,${.06*flicker})`;
    ctx.save();ctx.rotate(.15);
    ctx.fillRect(-bw*.25,bh*.05,bw*.5,bh*.18);
    ctx.restore();
    
    // Glass highlight
    ctx.strokeStyle=`rgba(200,230,250,${.04+flicker*.02})`;
    ctx.lineWidth=.3*this.sc;
    ctx.beginPath();ctx.moveTo(-bw*.7,bh*.15);ctx.quadraticCurveTo(-bw*.75,bh*.3,-bw*.5,bh*.4);ctx.stroke();
    
    // Hot center light
    ctx.fillStyle=`rgba(255,240,200,${.08*flicker})`;
    ctx.beginPath();ctx.arc(0,bh*.15,this.sz*.12,0,Math.PI*2);ctx.fill();
    
    ctx.restore();
  }
}

// ═══ AMBIENT PARTICLES ═══
class AmbientP{
  constructor(){this.x=Math.random()*W;this.y=Math.random()*H;this.sz=.2+Math.random()*.5;this.a=.02+Math.random()*.04;this.no=Math.random()*200;this.sp=.01+Math.random()*.02;this.an=Math.random()*Math.PI*2;this.tp=Math.random()*Math.PI*2;this.ts=.002+Math.random()*.005}
  update(t){const n=noise2D(this.no+t*.0002,this.y*.008);this.x+=Math.cos(this.an+n*2)*this.sp;this.y+=Math.sin(this.an+n)*this.sp;if(this.x<-5)this.x=W+5;if(this.x>W+5)this.x=-5;if(this.y<-5)this.y=H+5;if(this.y>H+5)this.y=-5;}
  draw(t){const tw=.2+Math.sin(t*this.ts+this.tp)*.8;const inWater=this.y>boundary;ctx.globalAlpha=this.a*tw;ctx.fillStyle=inWater?'rgba(100,180,210,.5)':'rgba(180,195,220,.5)';ctx.beginPath();ctx.arc(this.x,this.y,this.sz,0,Math.PI*2);ctx.fill();ctx.globalAlpha=1}
}

// ═══ INIT ═══
const stars=Array.from({length:40},()=>new Star);
const bottlesFar=Array.from({length:6},()=>new WishBottle(0));
const bottlesMid=Array.from({length:4},()=>new WishBottle(1));
const bottlesNear=Array.from({length:3},()=>new WishBottle(2));
const ambients=Array.from({length:45},()=>new AmbientP);
const touchBottles=[];

// ═══ RENDER ═══
function render(){
  t++;mxS+=(mx-mxS)*.03;myS+=(my-myS)*.03;
  
  drawBG(t);
  stars.forEach(s=>s.draw(t));
  drawCaustics(t);
  
  bottlesFar.forEach(b=>{b.update(t);b.draw(t)});
  ambients.forEach(a=>{a.update(t);a.draw(t)});
  bottlesMid.forEach(b=>{b.update(t);b.draw(t)});
  drawBoundaryMist(t);
  bottlesNear.forEach(b=>{b.update(t);b.draw(t)});
  touchBottles.forEach(b=>{b.update(t);b.draw(t)});
  for(let i=touchBottles.length-1;i>=0;i--){if(touchBottles[i].y<-60)touchBottles.splice(i,1);}
  
  if(t%5===0)for(let i=0;i<15;i++){ctx.fillStyle=`rgba(120,180,210,${Math.random()*.003})`;ctx.fillRect(Math.random()*W,Math.random()*H,1,1);}
  
  requestAnimationFrame(render);
}
render();

document.getElementById('env').addEventListener('click',()=>{document.getElementById('env').classList.add('opened');setTimeout(()=>{document.getElementById('exp').classList.add('active');document.getElementById('env').style.display='none'},700)});

const pc=document.getElementById('pc'),pctx=pc.getContext('2d'),fl=document.getElementById('fl');
const FILTERS=['Original','Message Glow','Ocean Glass','Drift','Bottled Light'];let cf=0,oD;
function genP(w,h){const o=document.createElement('canvas');o.width=w;o.height=h;const c=o.getContext('2d');const bg=c.createLinearGradient(0,0,w,h);bg.addColorStop(0,'#1E2848');bg.addColorStop(.4,'#182040');bg.addColorStop(.7,'#1A2845');bg.addColorStop(1,'#121E38');c.fillStyle=bg;c.fillRect(0,0,w,h);for(let i=0;i<10;i++){const x=w*.15+Math.random()*w*.7,y=h*.15+Math.random()*h*.7,r=20+Math.random()*50,g=c.createRadialGradient(x,y,0,x,y,r);g.addColorStop(0,`hsla(${200+Math.random()*30},30%,45%,.3)`);g.addColorStop(1,'transparent');c.fillStyle=g;c.beginPath();c.arc(x,y,r,0,Math.PI*2);c.fill()}for(let i=0;i<2e3;i++){c.fillStyle=`rgba(120,200,230,${Math.random()*.04})`;c.fillRect(Math.random()*w,Math.random()*h,1,1)}c.font='300 15px "Cormorant Garamond",serif';c.textAlign='center';c.fillStyle='rgba(120,200,230,.3)';c.fillText('your photo here',w/2,h*.83);c.font='300 10px "Nunito Sans",sans-serif';c.fillText('(tap to see art filters)',w/2,h*.89);return o}
function initP(){const f=document.getElementById('pf'),s=f.offsetWidth||280;pc.width=s;pc.height=s;pctx.drawImage(genP(s,s),0,0);oD=pctx.getImageData(0,0,s,s)}
function apF(n){const w=pc.width,h=pc.height;pctx.putImageData(oD,0,0);if(n==='Original')return;const id=pctx.getImageData(0,0,w,h),d=id.data;
if(n==='Message Glow'){for(let i=0;i<d.length;i+=4){d[i]=Math.min(255,d[i]*1.08+10);d[i+1]=Math.min(255,d[i+1]*1.05+12);d[i+2]=Math.min(255,d[i+2]*1.12+15)}pctx.putImageData(id,0,0);pctx.globalAlpha=.2;for(let i=0;i<5;i++)pctx.drawImage(pc,(Math.random()-.5)*5,(Math.random()-.5)*5);pctx.globalAlpha=1;for(let i=0;i<8;i++){const x=Math.random()*w,y=Math.random()*h,r=2+Math.random()*5,g=pctx.createRadialGradient(x,y,0,x,y,r*5);g.addColorStop(0,`hsla(${200+Math.random()*30},40%,60%,${.04+Math.random()*.04})`);g.addColorStop(1,'transparent');pctx.fillStyle=g;pctx.beginPath();pctx.arc(x,y,r*5,0,Math.PI*2);pctx.fill()}}
else if(n==='Ocean Glass'){for(let i=0;i<d.length;i+=4){d[i]=Math.min(255,d[i]*.8+10);d[i+1]=Math.min(255,d[i+1]*.9+18);d[i+2]=Math.min(255,d[i+2]*1.15+22)}pctx.putImageData(id,0,0);pctx.fillStyle='rgba(6,8,26,.08)';pctx.fillRect(0,0,w,h)}
else if(n==='Drift'){for(let i=0;i<d.length;i+=4){d[i]=Math.min(255,d[i]+15);d[i+1]=Math.min(255,d[i+1]+12);d[i+2]=Math.min(255,d[i+2]+18)}pctx.putImageData(id,0,0);pctx.globalAlpha=.28;for(let i=0;i<8;i++)pctx.drawImage(pc,(Math.random()-.5)*7,(Math.random()-.5)*7);pctx.globalAlpha=1;const v=pctx.createRadialGradient(w/2,h/2,w*.1,w/2,h/2,w*.55);v.addColorStop(0,'rgba(200,230,250,.04)');v.addColorStop(1,'rgba(6,8,26,.1)');pctx.fillStyle=v;pctx.fillRect(0,0,w,h)}
else if(n==='Bottled Light'){for(let i=0;i<d.length;i+=4){d[i]=Math.min(255,d[i]*1.1+12);d[i+1]=Math.min(255,d[i+1]*1.05+8);d[i+2]=d[i+2]*.9+5}pctx.putImageData(id,0,0);const v=pctx.createRadialGradient(w/2,h/2,w*.1,w/2,h/2,w*.55);v.addColorStop(0,'rgba(255,230,180,.05)');v.addColorStop(1,'rgba(6,8,26,.08)');pctx.fillStyle=v;pctx.fillRect(0,0,w,h);for(let i=0;i<10;i++){const x=Math.random()*w,y=Math.random()*h;pctx.fillStyle=`rgba(200,230,250,${.1+Math.random()*.15})`;pctx.beginPath();pctx.arc(x,y,.3+Math.random()*.5,0,Math.PI*2);pctx.fill();}}}
document.getElementById('pf').addEventListener('click',e=>{cf=(cf+1)%FILTERS.length;pc.style.transition='opacity .3s';pc.style.opacity='.4';setTimeout(()=>{apF(FILTERS[cf]);fl.textContent=FILTERS[cf];pc.style.opacity='1'},250);spB(e.clientX,e.clientY)});
function spB(x,y){for(let i=0;i<2;i++){const b=new WishBottle(2);b.x=x+(Math.random()-.5)*50;b.y=y+(Math.random()-.5)*30;b.vy=-(0.2+Math.random()*.4);b.alpha=.25+Math.random()*.2;touchBottles.push(b)}}
document.addEventListener('click',e=>{if(e.target.closest('.envelope-screen')||e.target.closest('.photo-frame'))return;spB(e.clientX,e.clientY)});
document.fonts.ready.then(()=>setTimeout(initP,100));addEventListener('resize',()=>{resize();setTimeout(initP,100)});
</script>
</body>
</html>
