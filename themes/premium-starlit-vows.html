<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>ðŸ’« LiveCardStudio â€” Starlit Vows</title><link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
<style>*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}html{scroll-behavior:smooth}body{font-family:'Cormorant Garamond',serif;background:#04040c;color:#e8d8e0;overflow-x:hidden;-webkit-font-smoothing:antialiased}.envelope-screen{position:fixed;top:0;left:0;width:100%;height:100vh;z-index:1000;display:flex;align-items:center;justify-content:center;background:radial-gradient(ellipse at 50% 60%,#0c0818,#04040c);transition:opacity 1.2s,transform 1.2s}.envelope-screen.opened{opacity:0;pointer-events:none;transform:scale(1.05)}.envelope-wrap{width:min(340px,90vw);height:230px;cursor:pointer;transform:translateY(20px);opacity:0;animation:ef 1.2s .3s cubic-bezier(.16,1,.3,1) forwards}@keyframes ef{to{transform:translateY(0);opacity:1}}.envelope-body{width:100%;height:100%;border-radius:14px;position:relative;background:linear-gradient(135deg,#120c20,#0a0618);box-shadow:0 20px 60px rgba(0,0,0,.7);overflow:hidden}.envelope-flap{position:absolute;top:0;left:0;width:100%;height:55%;background:linear-gradient(180deg,#160e28,#100a1e);clip-path:polygon(0 0,50% 65%,100% 0);transform-origin:top;transition:transform .8s cubic-bezier(.4,0,.2,1);z-index:2}.envelope-wrap.opening .envelope-flap{transform:rotateX(180deg)}.envelope-seal{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:64px;height:64px;border-radius:50%;z-index:3;background:radial-gradient(circle,#b0a0d8,#8878b0,#685898);box-shadow:0 0 30px rgba(160,140,220,.4);display:flex;align-items:center;justify-content:center;font-size:26px;animation:sg 3s ease-in-out infinite}@keyframes sg{0%,100%{box-shadow:0 0 25px rgba(160,140,220,.25)}50%{box-shadow:0 0 55px rgba(180,160,240,.55)}}.envelope-tagline{position:absolute;bottom:16px;left:0;right:0;text-align:center;font-style:italic;font-size:.78rem;color:rgba(170,150,210,.2);letter-spacing:.15em}canvas.bg{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0}canvas.sr{position:fixed;top:0;left:0;width:100%;height:100%;z-index:1;opacity:.4}canvas.cc{position:fixed;top:0;left:0;width:100%;height:100%;z-index:40;pointer-events:none}.card-content{position:relative;z-index:5;opacity:0;transition:opacity 1.5s ease .5s;min-height:100vh}.card-content.visible{opacity:1}.hero-section{height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:40px 20px}.hero-occasion{font-size:.7rem;letter-spacing:.4em;text-transform:uppercase;color:rgba(170,150,210,.4);margin-bottom:16px;opacity:0;animation:fu 1s 1.5s ease forwards}.hero-name{font-family:'Playfair Display',serif;font-size:clamp(2.2rem,8vw,5rem);font-weight:700;line-height:1.1;background:linear-gradient(135deg,#c8b8e8,#b0a0d8,#9080c0,#d0c0e8);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:20px;opacity:0;animation:fu 1.2s 1.8s ease forwards}.hero-divider{width:100px;height:2px;margin:16px auto;background:linear-gradient(to right,transparent,rgba(160,130,200,.3),transparent);opacity:0;animation:fu 1s 2.3s ease forwards}.hero-subtitle{font-style:italic;font-size:1.3rem;color:rgba(170,150,210,.35);opacity:0;animation:fu 1s 2.5s ease forwards}@keyframes fu{to{opacity:1}}.scroll-hint{position:absolute;bottom:40px;left:50%;transform:translateX(-50%);opacity:0;animation:fu 1s 3s ease forwards;display:flex;flex-direction:column;align-items:center;gap:8px}.scroll-hint span{font-size:.65rem;letter-spacing:.2em;text-transform:uppercase;color:rgba(170,150,210,.15)}.scroll-arrow{width:20px;height:20px;border-right:1px solid rgba(160,130,200,.2);border-bottom:1px solid rgba(160,130,200,.2);transform:rotate(45deg);animation:sb 2s ease-in-out infinite}@keyframes sb{0%,100%{transform:rotate(45deg) translate(0,0);opacity:.2}50%{transform:rotate(45deg) translate(5px,5px);opacity:.5}}.photo-section{padding:80px 20px;max-width:900px;margin:0 auto;opacity:0;transform:translateY(60px);transition:all 1.2s cubic-bezier(.16,1,.3,1)}.photo-section.in-view{opacity:1;transform:translateY(0)}.photo-frame{position:relative;border-radius:16px;overflow:hidden;box-shadow:0 30px 80px rgba(0,0,0,.5);transition:transform .15s}.photo-frame img{width:100%;display:block}.photo-overlay{position:absolute;inset:0;background:linear-gradient(180deg,transparent 60%,rgba(6,4,8,.85) 100%);pointer-events:none}.photo-duo{display:grid;grid-template-columns:1fr 1fr;gap:20px}.text-section{text-align:center;padding:60px 20px;max-width:700px;margin:0 auto;opacity:0;transform:translateY(40px);transition:all 1s cubic-bezier(.16,1,.3,1)}.text-section.in-view{opacity:1;transform:translateY(0)}.text-section p{font-size:1.4rem;line-height:1.9;color:rgba(200,180,230,.45);font-style:italic}.text-section .accent{color:#c0a8e0;font-weight:600}.sound-banner{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);z-index:50;padding:12px 28px;border-radius:40px;background:rgba(6,4,8,.9);border:1px solid rgba(160,130,200,.08);font-size:.8rem;letter-spacing:.15em;text-transform:uppercase;color:rgba(170,150,210,.4);cursor:pointer;display:flex;align-items:center;gap:10px;opacity:0;animation:fu .8s 3.5s ease forwards}.sound-bars{display:flex;gap:2px;align-items:end;height:14px}.sound-bar{width:3px;border-radius:2px;background:linear-gradient(to top,#685898,#b0a0d8);animation:sbr .8s ease-in-out infinite alternate}.sound-bar:nth-child(2){animation-delay:.15s}.sound-bar:nth-child(3){animation-delay:.3s}.sound-bar:nth-child(4){animation-delay:.45s}.sound-bars.paused .sound-bar{animation-play-state:paused;height:3px!important}@keyframes sbr{from{height:4px}to{height:14px}}.paint-section{padding:80px 20px;text-align:center}.paint-prompt{font-size:1rem;color:rgba(170,150,210,.2);margin-bottom:20px}.paint-canvas-wrap{max-width:800px;margin:0 auto;border-radius:16px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,.5)}.paint-canvas-wrap canvas{display:block;width:100%;cursor:crosshair;touch-action:none}.paint-tools{display:flex;justify-content:center;gap:10px;margin-top:16px}.paint-color{width:28px;height:28px;border-radius:50%;cursor:pointer;border:2px solid transparent;transition:all .3s}.paint-color.active{border-color:#fff;transform:scale(1.2)}.paint-clear{padding:6px 16px;border-radius:20px;border:1px solid rgba(160,130,200,.1);background:transparent;color:rgba(170,150,210,.35);font-family:'Cormorant Garamond',serif;font-size:.8rem;cursor:pointer}.message-section{padding:100px 20px;text-align:center;max-width:700px;margin:0 auto;opacity:0;transform:translateY(40px);transition:all 1.2s cubic-bezier(.16,1,.3,1)}.message-section.in-view{opacity:1;transform:translateY(0)}.msg-divider{width:60px;height:1px;margin:0 auto 30px;background:linear-gradient(to right,transparent,rgba(160,130,200,.3),transparent)}.msg-text{font-size:1.5rem;line-height:2;color:rgba(200,180,230,.5);font-style:italic;margin-bottom:40px}.msg-from{font-size:1rem;color:rgba(170,150,210,.3);letter-spacing:.15em}.gift-section{padding:80px 20px;text-align:center;opacity:0;transform:translateY(40px);transition:all 1s cubic-bezier(.16,1,.3,1)}.gift-section.in-view{opacity:1;transform:translateY(0)}.gift-card{display:inline-block;padding:40px 60px;border-radius:16px;background:rgba(14,10,18,.8);border:1px solid rgba(160,130,200,.06);cursor:pointer;transition:all .6s}.gift-card:hover{transform:translateY(-4px)}.gift-icon{font-size:2.5rem;margin-bottom:16px}.gift-label{font-size:.65rem;letter-spacing:.3em;text-transform:uppercase;color:rgba(170,150,210,.3);margin-bottom:12px}.gift-amount{font-family:'Playfair Display',serif;font-size:2.5rem;font-weight:700;background:linear-gradient(135deg,#c0a8e0,#9080c0);-webkit-background-clip:text;-webkit-text-fill-color:transparent}.gift-hidden{filter:blur(20px);transition:filter .8s}.gift-revealed{filter:blur(0)}.lcs-footer{text-align:center;padding:60px 20px 40px;border-top:1px solid rgba(160,130,200,.04)}.lcs-made-with{font-style:italic;font-size:.75rem;color:rgba(170,150,210,.1);letter-spacing:.2em;text-transform:uppercase;margin-bottom:12px}.lcs-logo{font-family:'Playfair Display',serif;font-size:1.1rem;font-weight:700;color:#b0a0d8;text-decoration:none}.lcs-tagline{font-style:italic;font-size:.72rem;color:rgba(170,150,210,.06);margin-top:8px}@media(max-width:600px){.photo-duo{grid-template-columns:1fr}.hero-name{font-size:clamp(1.8rem,9vw,3.5rem)}.msg-text{font-size:1.2rem}}</style></head>
<body>
<div class="envelope-screen" id="envelope"><div class="envelope-wrap" id="envWrap" onclick="openEnvelope()"><div class="envelope-body"><div class="envelope-flap"></div><div class="envelope-seal">ðŸ’«</div><div class="envelope-tagline">written in the stars</div></div></div></div>
<canvas class="bg" id="bg"></canvas><canvas class="sr" id="sr"></canvas><canvas class="cc" id="confetti"></canvas>
<div class="sound-banner" onclick="toggleSound()"><div class="sound-bars" id="soundBars"><div class="sound-bar"></div><div class="sound-bar"></div><div class="sound-bar"></div><div class="sound-bar"></div></div><span id="soundLabel">garden</span></div>
<div class="card-content" id="cardContent">
  <section class="hero-section"><div class="hero-occasion">Two Stars, One Sky</div><h1 class="hero-name">Mia<br>&<br>Daniel</h1><div class="hero-divider"></div><div class="hero-subtitle">the universe made you for each other</div><div class="scroll-hint"><span>reach for the stars</span><div class="scroll-arrow"></div></div></section>
  <section class="photo-section" data-reveal><div class="photo-frame" data-tilt><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='900' height='600'%3E%3Crect fill='%230e0a14' width='900' height='600'/%3E%3Ctext x='450' y='300' text-anchor='middle' fill='rgba(170,150,210,.08)' font-family='serif' font-size='24'%3EYour Photo Here%3C/text%3E%3C/svg%3E" alt=""><div class="photo-overlay"></div></div></section>
  <section class="text-section" data-reveal><p>Before time began, your stars were already falling toward each other â€” pulled by a gravity older than <span class="accent">the universe itself</span>.</p></section>
  <section class="photo-section" data-reveal><div class="photo-duo"><div class="photo-frame" data-tilt><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='533'%3E%3Crect fill='%23120c18' width='400' height='533'/%3E%3Ctext x='200' y='267' text-anchor='middle' fill='rgba(170,150,210,.08)' font-family='serif' font-size='18'%3EPhoto 2%3C/text%3E%3C/svg%3E" alt=""><div class="photo-overlay"></div></div><div class="photo-frame" data-tilt><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='533'%3E%3Crect fill='%23120c18' width='400' height='533'/%3E%3Ctext x='200' y='267' text-anchor='middle' fill='rgba(170,150,210,.08)' font-family='serif' font-size='18'%3EPhoto 3%3C/text%3E%3C/svg%3E" alt=""><div class="photo-overlay"></div></div></div></section>
  <section class="text-section" data-reveal><p>Some love stories are written in ink. Yours was written in <span class="accent">starlight</span> â€” ancient, luminous, and visible from every corner of the sky.</p></section>
  <section class="photo-section" data-reveal><div class="photo-frame" data-tilt><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='900' height='600'%3E%3Crect fill='%230e0a14' width='900' height='600'/%3E%3Ctext x='450' y='300' text-anchor='middle' fill='rgba(170,150,210,.08)' font-family='serif' font-size='24'%3EPhoto 4%3C/text%3E%3C/svg%3E" alt=""><div class="photo-overlay"></div></div></section>
  <section class="text-section" data-reveal><p>Tonight, two constellations become one. Two orbits merge. And the sky will never look the same â€” because <span class="accent">your love changed the universe</span>.</p></section>
  <section class="paint-section" data-reveal><div class="paint-prompt">ðŸ’« paint the cosmos ðŸ’«</div><div class="paint-canvas-wrap"><canvas id="paintCanvas" width="800" height="500"></canvas></div><div class="paint-tools"><div class="paint-color active" style="background:#b0a0d8" data-color="#b0a0d8"></div><div class="paint-color" style="background:#d0c0e8" data-color="#d0c0e8"></div><div class="paint-color" style="background:#7868a8" data-color="#7868a8"></div><div class="paint-color" style="background:#d4a060" data-color="#d4a060"></div><div class="paint-color" style="background:#e0d0f0" data-color="#e0d0f0"></div><button class="paint-clear" onclick="clearPaint()">clear</button></div></section>
  <section class="message-section" data-reveal><div class="msg-divider"></div><div class="msg-text">To Mia & Daniel â€” your love is the kind the poets wrote about and the astronomers searched for. Two stars that circled for lifetimes before finally falling into the same orbit. May your marriage be as vast as the sky and as constant as the North Star. The universe celebrates with you tonight.</div><div class="msg-from">â€” With all our love ðŸ’«</div></section>
  <section class="gift-section" data-reveal><div class="gift-card" onclick="revealGift(this)"><div class="gift-icon">ðŸ’«</div><div class="gift-label">a cosmic gift</div><div class="gift-amount gift-hidden">$200</div></div></section>
  <footer class="lcs-footer"><div class="lcs-made-with">crafted on</div><a href="https://livecardstudio.com" class="lcs-logo">ðŸ’« LiveCardStudio</a><div class="lcs-tagline">cards that live & breathe</div></footer>
</div>
<script>

const bgC=document.getElementById('bg'),bgCtx=bgC.getContext('2d');let W,H;
let audioCtx,analyser,analyserData,soundPlaying=false;
const galaxyStars=[],nebulae=[],shootingStars=[],orbitStars={a:{},b:{}},constellationHeart=[],stardust=[],rings=[];

function initBg(){W=bgC.width=window.innerWidth;H=bgC.height=window.innerHeight;
galaxyStars.length=0;nebulae.length=0;shootingStars.length=0;constellationHeart.length=0;stardust.length=0;rings.length=0;
const cx=W*.5,cy=H*.4;
// Background stars
for(let i=0;i<300;i++)galaxyStars.push({x:Math.random()*W,y:Math.random()*H,r:.3+Math.random()*1.8,hue:230+Math.random()*60,a:.03+Math.random()*.06,tw:Math.random()*Math.PI*2});
// Two orbiting stars (the couple)
orbitStars.a={hue:280,size:6,orbitR:35,speed:.0008,phase:0,trail:[]};
orbitStars.b={hue:40,size:5,orbitR:35,speed:.0008,phase:Math.PI,trail:[]};
// Nebula clouds
for(let i=0;i<5;i++)nebulae.push({x:cx+(Math.random()-.5)*W*.5,y:cy+(Math.random()-.5)*H*.3,rx:40+Math.random()*80,ry:20+Math.random()*40,hue:250+Math.random()*50,a:.008+Math.random()*.008,phase:Math.random()*Math.PI*2});
// Heart constellation (star points forming a heart)
const hPts=16;for(let i=0;i<hPts;i++){const t2=i/hPts*Math.PI*2;
// Heart parametric: x=16sin^3(t), y=13cos(t)-5cos(2t)-2cos(3t)-cos(4t)
const hx=16*Math.pow(Math.sin(t2),3);const hy=-(13*Math.cos(t2)-5*Math.cos(2*t2)-2*Math.cos(3*t2)-Math.cos(4*t2));
constellationHeart.push({x:cx+hx*3.5,y:cy-H*.1+hy*3.5,r:1+Math.random()*1.5,a:.04+Math.random()*.03})}
// Stardust
for(let i=0;i<100;i++)stardust.push({x:Math.random()*W,y:Math.random()*H,r:.2+Math.random()*1,vy:(Math.random()-.5)*.02,vx:(Math.random()-.5)*.01,a:.02+Math.random()*.03,phase:Math.random()*Math.PI*2});
// Wedding rings (two overlapping circles)
rings.push({x:cx-12,y:cy+H*.15,r:14,hue:40,a:.04});
rings.push({x:cx+12,y:cy+H*.15,r:14,hue:40,a:.04});
// Shooting stars
for(let i=0;i<3;i++)shootingStars.push({x:0,y:0,vx:0,vy:0,life:0,timer:Math.random()*150,interval:80+Math.random()*200,active:false})}

function renderBg(t){bgCtx.fillStyle='#04040c';bgCtx.fillRect(0,0,W,H);const sY=window.scrollY||0;const cx=W*.5,cy=H*.4;
bgCtx.globalCompositeOperation='screen';
// Nebulae
nebulae.forEach(n=>{n.phase+=.0003;const pulse=Math.sin(t*.0004+n.phase)*.25+.75;
const ng=bgCtx.createRadialGradient(n.x,n.y-sY*.02,0,n.x,n.y-sY*.02,n.rx*pulse);
ng.addColorStop(0,'hsla('+n.hue+',45%,45%,'+(n.a*pulse)+')');ng.addColorStop(.5,'hsla('+(n.hue+15)+',35%,35%,'+(n.a*.3*pulse)+')');ng.addColorStop(1,'hsla('+n.hue+',25%,25%,0)');
bgCtx.save();bgCtx.translate(n.x,n.y-sY*.02);bgCtx.rotate(n.phase*.5);bgCtx.scale(1,n.ry/n.rx);bgCtx.fillStyle=ng;bgCtx.beginPath();bgCtx.arc(0,0,n.rx*pulse,0,Math.PI*2);bgCtx.fill();bgCtx.restore()});
// Stars
galaxyStars.forEach(s=>{const tw=Math.sin(t*.002+s.tw)*.3+.7;bgCtx.beginPath();bgCtx.arc(s.x,s.y-sY*.01,s.r*tw,0,Math.PI*2);bgCtx.fillStyle='hsla('+s.hue+',50%,70%,'+(s.a*tw)+')';bgCtx.fill()});
// Heart constellation
bgCtx.strokeStyle='rgba(180,160,220,.02)';bgCtx.lineWidth=.5;bgCtx.beginPath();
constellationHeart.forEach((p,i)=>{const py=p.y-sY*.03;i===0?bgCtx.moveTo(p.x,py):bgCtx.lineTo(p.x,py)});bgCtx.closePath();bgCtx.stroke();
constellationHeart.forEach(p=>{const py=p.y-sY*.03;const pulse=Math.sin(t*.003+p.x*.01)*.2+.8;
bgCtx.beginPath();bgCtx.arc(p.x,py,p.r*pulse,0,Math.PI*2);bgCtx.fillStyle='rgba(200,180,240,'+(p.a*pulse)+')';bgCtx.fill();
const sg=bgCtx.createRadialGradient(p.x,py,0,p.x,py,p.r*4);sg.addColorStop(0,'rgba(200,180,240,'+(p.a*.3*pulse)+')');sg.addColorStop(1,'rgba(180,160,220,0)');bgCtx.fillStyle=sg;bgCtx.beginPath();bgCtx.arc(p.x,py,p.r*4,0,Math.PI*2);bgCtx.fill()});
// Two orbiting stars (the couple)
[orbitStars.a,orbitStars.b].forEach(os=>{os.phase+=os.speed;const ox=cx+Math.cos(os.phase)*os.orbitR,oy=cy+Math.sin(os.phase)*os.orbitR*.4-sY*.03;
os.trail.push({x:ox,y:oy,a:.08});if(os.trail.length>40)os.trail.shift();
os.trail.forEach((tp,i)=>{const fa=tp.a*(i/os.trail.length);bgCtx.beginPath();bgCtx.arc(tp.x,tp.y,1.5*(i/os.trail.length),0,Math.PI*2);bgCtx.fillStyle='hsla('+os.hue+',60%,65%,'+fa+')';bgCtx.fill()});
// Star glow
const sg=bgCtx.createRadialGradient(ox,oy,0,ox,oy,os.size*3);sg.addColorStop(0,'hsla('+os.hue+',70%,70%,.12)');sg.addColorStop(.4,'hsla('+os.hue+',60%,60%,.04)');sg.addColorStop(1,'hsla('+os.hue+',50%,50%,0)');bgCtx.fillStyle=sg;bgCtx.beginPath();bgCtx.arc(ox,oy,os.size*3,0,Math.PI*2);bgCtx.fill();
// Star cross flare
const fa=.08+Math.sin(t*.003)*.03;bgCtx.strokeStyle='hsla('+os.hue+',60%,70%,'+fa+')';bgCtx.lineWidth=.5;bgCtx.beginPath();bgCtx.moveTo(ox-os.size*2,oy);bgCtx.lineTo(ox+os.size*2,oy);bgCtx.moveTo(ox,oy-os.size*2);bgCtx.lineTo(ox,oy+os.size*2);bgCtx.stroke();
// Core
bgCtx.beginPath();bgCtx.arc(ox,oy,os.size*.6,0,Math.PI*2);bgCtx.fillStyle='hsla('+os.hue+',60%,80%,.15)';bgCtx.fill()});
// Orbit path (faint)
bgCtx.beginPath();bgCtx.ellipse(cx,cy-sY*.03,orbitStars.a.orbitR,orbitStars.a.orbitR*.4,0,0,Math.PI*2);bgCtx.strokeStyle='rgba(160,140,200,.015)';bgCtx.lineWidth=.5;bgCtx.stroke();
// Wedding rings
rings.forEach(rn=>{const ry=rn.y-sY*.04;const pulse=Math.sin(t*.001+rn.x*.1)*.1+.9;
bgCtx.beginPath();bgCtx.arc(rn.x,ry,rn.r*pulse,0,Math.PI*2);bgCtx.strokeStyle='hsla('+rn.hue+',50%,60%,'+(rn.a*pulse)+')';bgCtx.lineWidth=1.5;bgCtx.stroke();
const rg=bgCtx.createRadialGradient(rn.x,ry,rn.r*.8,rn.x,ry,rn.r*1.5);rg.addColorStop(0,'hsla('+rn.hue+',40%,50%,'+(rn.a*.2)+')');rg.addColorStop(1,'hsla('+rn.hue+',30%,40%,0)');bgCtx.fillStyle=rg;bgCtx.beginPath();bgCtx.arc(rn.x,ry,rn.r*1.5,0,Math.PI*2);bgCtx.fill()});
// Stardust
stardust.forEach(sd=>{sd.x+=sd.vx+Math.sin(t*.0003+sd.phase)*.02;sd.y+=sd.vy;if(sd.y<-5)sd.y=H+5;if(sd.y>H+5)sd.y=-5;
const pulse=Math.sin(t*.003+sd.phase)*.3+.7;bgCtx.beginPath();bgCtx.arc(sd.x,sd.y-sY*.01,sd.r*pulse,0,Math.PI*2);bgCtx.fillStyle='rgba(200,190,230,'+(sd.a*pulse)+')';bgCtx.fill()});
// Shooting stars
shootingStars.forEach(ss=>{ss.timer++;if(!ss.active&&ss.timer>ss.interval){ss.active=true;ss.timer=0;ss.interval=100+Math.random()*250;ss.x=Math.random()*W*.7;ss.y=Math.random()*H*.25;ss.vx=3+Math.random()*4;ss.vy=1+Math.random()*2;ss.life=1}
if(ss.active){ss.x+=ss.vx;ss.y+=ss.vy;ss.life-=.012;if(ss.life<=0){ss.active=false;return}
bgCtx.beginPath();bgCtx.moveTo(ss.x,ss.y-sY*.01);bgCtx.lineTo(ss.x-ss.vx*15,ss.y-ss.vy*15-sY*.01);
const tg=bgCtx.createLinearGradient(ss.x,ss.y-sY*.01,ss.x-ss.vx*15,ss.y-ss.vy*15-sY*.01);tg.addColorStop(0,'rgba(220,200,255,'+(ss.life*.25)+')');tg.addColorStop(1,'rgba(180,160,220,0)');bgCtx.strokeStyle=tg;bgCtx.lineWidth=1.5;bgCtx.stroke();
bgCtx.beginPath();bgCtx.arc(ss.x,ss.y-sY*.01,1.5,0,Math.PI*2);bgCtx.fillStyle='rgba(240,230,255,'+(ss.life*.4)+')';bgCtx.fill()}});
renderEnhancements(bgCtx,t);
bgCtx.globalCompositeOperation='source-over'}

function initAudio(){audioCtx=new(window.AudioContext||window.webkitAudioContext)();analyser=audioCtx.createAnalyser();analyser.fftSize=256;analyserData=new Uint8Array(analyser.frequencyBinCount);const m=audioCtx.createGain();m.gain.value=.12;m.connect(analyser);analyser.connect(audioCtx.destination);
[130.81,196,261.63,392].forEach((f,i)=>{const o=audioCtx.createOscillator();o.type=i%2?'triangle':'sine';o.frequency.value=f;const g=audioCtx.createGain();g.gain.value=.01;const lfo=audioCtx.createOscillator();lfo.type='sine';lfo.frequency.value=.02+i*.005;const lg=audioCtx.createGain();lg.gain.value=.003;lfo.connect(lg);lg.connect(g.gain);lfo.start();o.connect(g);g.connect(m);o.start()});
const cosmic=[523.25,659.25,783.99,659.25,523.25,392];let ci=0;
function chime(){if(!soundPlaying)return;setTimeout(()=>{if(!soundPlaying)return;const f=cosmic[ci%cosmic.length];ci++;const o=audioCtx.createOscillator();o.type='sine';o.frequency.value=f;const g=audioCtx.createGain();g.gain.setValueAtTime(.018,audioCtx.currentTime);g.gain.exponentialRampToValueAtTime(.001,audioCtx.currentTime+2.5);o.connect(g);g.connect(m);o.start();o.stop(audioCtx.currentTime+2.5);chime()},(2+Math.random()*3)*1000)}chime()}
function toggleSound(){if(!soundPlaying){if(!audioCtx)initAudio();else audioCtx.resume();soundPlaying=true;document.getElementById('soundBars').classList.remove('paused')}else{audioCtx.suspend();soundPlaying=false;document.getElementById('soundBars').classList.add('paused')}}
function renderSRCustom(ctx,bass,t){const rg=ctx.createRadialGradient(srC.width/2,srC.height*.4,0,srC.width/2,srC.height*.4,bass*350);rg.addColorStop(0,'rgba(160,140,220,'+(bass*.07)+')');rg.addColorStop(1,'rgba(120,100,180,0)');ctx.fillStyle=rg;ctx.fillRect(0,0,srC.width,srC.height)}



// === SIMPLEX NOISE ENGINE ===
const _SN=(()=>{const p=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];
const perm=new Uint8Array(512),permMod12=new Uint8Array(512);
for(let i=0;i<512;i++){perm[i]=p[i&255];permMod12[i]=perm[i]%12}
const G2=(3-Math.sqrt(3))/6,G3=1/6;
const grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]];
function dot2(g,x,y){return g[0]*x+g[1]*y}
function dot3(g,x,y,z){return g[0]*x+g[1]*y+g[2]*z}
return{
noise2D(x,y){const s=(x+y)*.5*(Math.sqrt(3)-1),i=Math.floor(x+s),j=Math.floor(y+s),tt=(i+j)*G2,X0=i-tt,Y0=j-tt,x0=x-X0,y0=y-Y0;
let i1,j1;if(x0>y0){i1=1;j1=0}else{i1=0;j1=1}
const x1=x0-i1+G2,y1=y0-j1+G2,x2=x0-1+2*G2,y2=y0-1+2*G2,ii=i&255,jj=j&255;
let n0=0,n1=0,n2=0,t0=.5-x0*x0-y0*y0;if(t0>=0){t0*=t0;n0=t0*t0*dot2(grad3[permMod12[ii+perm[jj]]],x0,y0)}
let t1=.5-x1*x1-y1*y1;if(t1>=0){t1*=t1;n1=t1*t1*dot2(grad3[permMod12[ii+i1+perm[jj+j1]]],x1,y1)}
let t2=.5-x2*x2-y2*y2;if(t2>=0){t2*=t2;n2=t2*t2*dot2(grad3[permMod12[ii+1+perm[jj+1]]],x2,y2)}
return 70*(n0+n1+n2)},
noise3D(x,y,z){const s=(x+y+z)/3,i=Math.floor(x+s),j=Math.floor(y+s),k=Math.floor(z+s),tt=(i+j+k)*G3,X0=i-tt,Y0=j-tt,Z0=k-tt,x0=x-X0,y0=y-Y0,z0=z-Z0;
let i1,j1,k1,i2,j2,k2;if(x0>=y0){if(y0>=z0){i1=1;j1=0;k1=0;i2=1;j2=1;k2=0}else if(x0>=z0){i1=1;j1=0;k1=0;i2=1;j2=0;k2=1}else{i1=0;j1=0;k1=1;i2=1;j2=0;k2=1}}else{if(y0<z0){i1=0;j1=0;k1=1;i2=0;j2=1;k2=1}else if(x0<z0){i1=0;j1=1;k1=0;i2=0;j2=1;k2=1}else{i1=0;j1=1;k1=0;i2=1;j2=1;k2=0}}
const x1=x0-i1+G3,y1=y0-j1+G3,z1=z0-k1+G3,x2=x0-i2+2*G3,y2=y0-j2+2*G3,z2=z0-k2+2*G3,x3=x0-1+3*G3,y3=y0-1+3*G3,z3=z0-1+3*G3;
const ii=i&255,jj=j&255,kk=k&255;let n0=0,n1=0,n2=0,n3=0;
let t0=.6-x0*x0-y0*y0-z0*z0;if(t0>=0){t0*=t0;n0=t0*t0*dot3(grad3[permMod12[ii+perm[jj+perm[kk]]]],x0,y0,z0)}
let t1=.6-x1*x1-y1*y1-z1*z1;if(t1>=0){t1*=t1;n1=t1*t1*dot3(grad3[permMod12[ii+i1+perm[jj+j1+perm[kk+k1]]]],x1,y1,z1)}
let t2=.6-x2*x2-y2*y2-z2*z2;if(t2>=0){t2*=t2;n2=t2*t2*dot3(grad3[permMod12[ii+i2+perm[jj+j2+perm[kk+k2]]]],x2,y2,z2)}
let t3=.6-x3*x3-y3*y3-z3*z3;if(t3>=0){t3*=t3;n3=t3*t3*dot3(grad3[permMod12[ii+1+perm[jj+1+perm[kk+1]]]],x3,y3,z3)}
return 32*(n0+n1+n2+n3)}
}})();



// === ANIMATED SHIMMER + VIGNETTE + DOUBLE-TAP EGG ===
let _shimPhase=0;
const _eggP=[];let _lastTap=0;
function _onDoubleTap(ex,ey){const now=Date.now();if(now-_lastTap<350){for(let i=0;i<40;i++){const ang=(i/40)*Math.PI*2;const spd=1+Math.random()*4;const delay=Math.random()*12;_eggP.push({x:ex,y:ey,vx:Math.cos(ang)*spd,vy:Math.sin(ang)*spd,sz:2+Math.random()*4,l:1,d:.003+Math.random()*.005,h:260+Math.random()*35-35/2,delay:delay,born:0})}}
_lastTap=now}
document.addEventListener('click',e=>_onDoubleTap(e.clientX,e.clientY));
document.addEventListener('touchend',e=>{if(e.changedTouches&&e.changedTouches.length)_onDoubleTap(e.changedTouches[0].clientX,e.changedTouches[0].clientY)},{passive:true});
function _renderT3(ctx,t){
// Breathing vignette
_shimPhase+=.008;const vigA=.03+Math.sin(_shimPhase)*.015;
const vig=ctx.createRadialGradient(W/2,H/2,W*.2,W/2,H/2,W*.7);vig.addColorStop(0,'rgba(0,0,0,0)');vig.addColorStop(.7,'rgba(30,25,60,'+(vigA*.5)+')');vig.addColorStop(1,'rgba(30,25,60,'+vigA+')');ctx.fillStyle=vig;ctx.fillRect(0,0,W,H);
// Shimmer spotlight (drifting radial glow)
const sx=W/2+_SN.noise2D(_shimPhase*.3,0)*W*.25;const sy=H/2+_SN.noise2D(0,_shimPhase*.3)*H*.2;
const sg=ctx.createRadialGradient(sx,sy,0,sx,sy,W*.15);sg.addColorStop(0,'rgba(160,140,220,.018)');sg.addColorStop(.5,'rgba(160,140,220,.008)');sg.addColorStop(1,'rgba(160,140,220,0)');ctx.fillStyle=sg;ctx.fillRect(0,0,W,H);
// Double-tap egg particles
for(let i=_eggP.length-1;i>=0;i--){const ep=_eggP[i];ep.born++;if(ep.born<ep.delay)continue;
ep.x+=ep.vx;ep.y+=ep.vy;ep.vx*=.985;ep.vy*=.985;ep.vy+=.015;ep.l-=ep.d;if(ep.l<=0){_eggP.splice(i,1);continue}
const ea=ep.l*.6;ctx.beginPath();ctx.arc(ep.x,ep.y,ep.sz*ep.l,0,Math.PI*2);ctx.fillStyle='hsla('+ep.h+',70%,60%,'+ea+')';ctx.fill();
const eg=ctx.createRadialGradient(ep.x,ep.y,0,ep.x,ep.y,ep.sz*3);eg.addColorStop(0,'hsla('+ep.h+',60%,65%,'+(ea*.15)+')');eg.addColorStop(1,'hsla('+ep.h+',50%,55%,0)');ctx.fillStyle=eg;ctx.beginPath();ctx.arc(ep.x,ep.y,ep.sz*3,0,Math.PI*2);ctx.fill()}
}

// === TAP BURST SYSTEM ===
const _BP=[];
function _onTapBurst(ex,ey){for(let i=0;i<16;i++){const ang=Math.random()*Math.PI*2;const spd=.5+Math.random()*2.5;_BP.push({x:ex,y:ey,vx:Math.cos(ang)*spd,vy:Math.sin(ang)*spd,sz:1+Math.random()*3,l:1,d:.008+Math.random()*.012,h:260+Math.random()*30-30*.5})}}
document.addEventListener('click',e=>_onTapBurst(e.clientX,e.clientY));
document.addEventListener('touchstart',e=>{if(e.touches.length)_onTapBurst(e.touches[0].clientX,e.touches[0].clientY)},{passive:true});
function _renderBurst(ctx){for(let i=_BP.length-1;i>=0;i--){const bp=_BP[i];bp.x+=bp.vx;bp.y+=bp.vy;bp.vx*=.97;bp.vy*=.97;bp.vy+=.02;bp.l-=bp.d;if(bp.l<=0){_BP.splice(i,1);continue}
ctx.beginPath();ctx.arc(bp.x,bp.y,bp.sz*bp.l,0,Math.PI*2);ctx.fillStyle='hsla('+bp.h+',65%,60%,'+(bp.l*.5)+')';ctx.fill();
const bg=ctx.createRadialGradient(bp.x,bp.y,0,bp.x,bp.y,bp.sz*5);bg.addColorStop(0,'hsla('+bp.h+',60%,60%,'+(bp.l*.08)+')');bg.addColorStop(1,'hsla('+bp.h+',50%,50%,0)');ctx.fillStyle=bg;ctx.beginPath();ctx.arc(bp.x,bp.y,bp.sz*5,0,Math.PI*2);ctx.fill();
}}

// === NOISE FLOW FIELD ATMOSPHERE ===
const _FF={res:25,cols:0,rows:0,field:[],zOff:0};
const _AP=[];const _AP_MAX=100;
function _initFF(){_FF.cols=Math.ceil(W/_FF.res);_FF.rows=Math.ceil(H/_FF.res);_FF.field=new Float32Array(_FF.cols*_FF.rows)}
function _updateFF(t){_FF.zOff+=.0008;for(let r=0;r<_FF.rows;r++)for(let c=0;c<_FF.cols;c++){_FF.field[r*_FF.cols+c]=_SN.noise3D(c*.06,r*.06,_FF.zOff)*Math.PI*4}}
function _getAngle(x,y){const c=Math.floor(x/_FF.res),r=Math.floor(y/_FF.res);if(c<0||c>=_FF.cols||r<0||r>=_FF.rows)return 0;return _FF.field[r*_FF.cols+c]}
function _spawnAP(){while(_AP.length<_AP_MAX)_AP.push({x:Math.random()*W,y:Math.random()*H,px:0,py:0,vx:0,vy:0,life:1,maxL:200+Math.random()*400,age:0,hShift:Math.random()*30,sz:.5+Math.random()*1.5})}
function _renderAtmos(ctx,t){_updateFF(t);
const pulse=.85+Math.sin(t*.0004)*.15;
for(let i=_AP.length-1;i>=0;i--){const p=_AP[i];p.px=p.x;p.py=p.y;
const a=_getAngle(p.x,p.y);p.vx+=Math.cos(a)*0.2;p.vy+=Math.sin(a)*0.2;
// Mouse interaction
if(_mA){const dx=_mX-p.x,dy=_mY-p.y,d=Math.sqrt(dx*dx+dy*dy);if(d<150&&d>0){const f=(1-d/150)*0.1;p.vx+=(dx/d)*f;p.vy+=(dy/d)*f}}
p.vx*=.96;p.vy*=.96;const spd=Math.sqrt(p.vx*p.vx+p.vy*p.vy);if(spd>3){p.vx=(p.vx/spd)*3;p.vy=(p.vy/spd)*3}
p.x+=p.vx;p.y+=p.vy;p.age++;p.life=1-p.age/p.maxL;
if(p.x<-10)p.x=W+10;if(p.x>W+10)p.x=-10;if(p.y<-10)p.y=H+10;if(p.y>H+10)p.y=-10;
if(p.life<=0){p.x=Math.random()*W;p.y=Math.random()*H;p.px=p.x;p.py=p.y;p.vx=0;p.vy=0;p.life=1;p.age=0;p.maxL=200+Math.random()*400;continue}
// Draw with trail
const al=p.life*0.2*pulse;const h=(260+p.hShift+_gHue)%360;
ctx.strokeStyle='hsla('+h+',45%,65%,'+al+')';ctx.lineWidth=p.sz*p.life;ctx.beginPath();ctx.moveTo(p.px,p.py);ctx.lineTo(p.x,p.y);ctx.stroke();
// Glow dot
if(p.sz>1){ctx.beginPath();ctx.arc(p.x,p.y,p.sz*p.life*.8,0,Math.PI*2);ctx.fillStyle='hsla('+h+',45%,80%,'+(al*.4)+')';ctx.fill()}
}}
_initFF();_spawnAP();

// === LIVING ART ENHANCEMENTS ===
let mouseX=W/2,mouseY=H/2,mouseActive=false;
const cursorTrail=[];
let globalHueShift=0;
let rareTimer=0;
const rareParticles=[];

document.addEventListener('mousemove',e=>{mouseX=e.clientX;mouseY=e.clientY;mouseActive=true;
// Spawn trail particle
if(cursorTrail.length<25)cursorTrail.push({x:e.clientX,y:e.clientY,r:1+Math.random()*3,life:1,dec:.015+Math.random()*.01})});
document.addEventListener('touchmove',e=>{mouseX=e.touches[0].clientX;mouseY=e.touches[0].clientY;mouseActive=true;
if(cursorTrail.length<15)cursorTrail.push({x:e.touches[0].clientX,y:e.touches[0].clientY,r:1+Math.random()*3,life:1,dec:.015+Math.random()*.01})},{passive:true});
document.addEventListener('mouseleave',()=>{mouseActive=false});

function renderEnhancements(ctx,t){
// Slow hue evolution (shifts palette over minutes)
globalHueShift=Math.sin(t*.00003)*25;

// Cursor trail particles
for(let i=cursorTrail.length-1;i>=0;i--){const p=cursorTrail[i];p.life-=p.dec;p.r*=.98;p.y+=.2;
if(p.life<=0){cursorTrail.splice(i,1);continue}
ctx.beginPath();ctx.arc(p.x,p.y,p.r*p.life,0,Math.PI*2);ctx.fillStyle='rgba(180,160,240,'+(p.life*.3)+')';ctx.fill();
const tg=ctx.createRadialGradient(p.x,p.y,0,p.x,p.y,p.r*3);tg.addColorStop(0,'rgba(180,160,240,'+(p.life*.08)+')');tg.addColorStop(1,'rgba(180,160,240,0)');ctx.fillStyle=tg;ctx.beginPath();ctx.arc(p.x,p.y,p.r*3,0,Math.PI*2);ctx.fill()}

// Mouse proximity glow (subtle ambient light around cursor)
if(mouseActive){const mg=ctx.createRadialGradient(mouseX,mouseY,0,mouseX,mouseY,80);mg.addColorStop(0,'rgba(180,160,240,.03)');mg.addColorStop(1,'rgba(180,160,240,0)');ctx.fillStyle=mg;ctx.beginPath();ctx.arc(mouseX,mouseY,80,0,Math.PI*2);ctx.fill()}

// Rare event particles
rareTimer++;if(rareTimer>600+Math.random()*900){rareTimer=0;
for(let i=0;i<12;i++)rareParticles.push({x:W*(.2+Math.random()*.6),y:H*(.2+Math.random()*.4),vx:(Math.random()-.5)*.8,vy:(Math.random()-.5)*.8,r:1+Math.random()*3,life:1,dec:.005+Math.random()*.008,hue:270+Math.random()*40})}
for(let i=rareParticles.length-1;i>=0;i--){const rp=rareParticles[i];rp.x+=rp.vx;rp.y+=rp.vy;rp.vx*=.99;rp.vy*=.99;rp.life-=rp.dec;
if(rp.life<=0){rareParticles.splice(i,1);continue}
ctx.beginPath();ctx.arc(rp.x,rp.y,rp.r*rp.life,0,Math.PI*2);ctx.fillStyle='hsla('+rp.hue+',70%,60%,'+(rp.life*.4)+')';ctx.fill();
const rg=ctx.createRadialGradient(rp.x,rp.y,0,rp.x,rp.y,rp.r*4);rg.addColorStop(0,'hsla('+rp.hue+',60%,55%,'+(rp.life*.1)+')');rg.addColorStop(1,'hsla('+rp.hue+',50%,45%,0)');ctx.fillStyle=rg;ctx.beginPath();ctx.arc(rp.x,rp.y,rp.r*4,0,Math.PI*2);ctx.fill()}
}

// === SHARED SYSTEMS ===
const srC=document.getElementById('sr'),srCtx=srC.getContext('2d');function initSR(){srC.width=W;srC.height=H}
function renderSR(t){srCtx.clearRect(0,0,srC.width,srC.height);if(!soundPlaying||!analyser)return;analyser.getByteFrequencyData(analyserData);const bass=analyserData.slice(0,4).reduce((a,b)=>a+b,0)/(4*255);srCtx.globalCompositeOperation='screen';renderSRCustom(srCtx,bass,t);srCtx.globalCompositeOperation='source-over'}
const pC=document.getElementById('paintCanvas'),pCtx=pC.getContext('2d');let paintColor,isPainting=false,lastP=null;
function initPaint(){const ac=document.querySelector('.paint-color.active');paintColor=ac?ac.dataset.color:'#b0a0d8';pCtx.fillStyle='#080618';pCtx.fillRect(0,0,800,500)}
function paintAt(x,y){const r=pC.getBoundingClientRect(),px=(x-r.left)*(800/r.width),py=(y-r.top)*(500/r.height);if(lastP){pCtx.beginPath();pCtx.moveTo(lastP.x,lastP.y);pCtx.lineTo(px,py);pCtx.strokeStyle=paintColor;pCtx.lineWidth=4;pCtx.lineCap='round';pCtx.globalAlpha=.4;pCtx.stroke();pCtx.globalAlpha=1}lastP={x:px,y:py}}
pC.addEventListener('mousedown',e=>{isPainting=true;lastP=null;paintAt(e.clientX,e.clientY)});pC.addEventListener('mousemove',e=>{if(isPainting)paintAt(e.clientX,e.clientY)});pC.addEventListener('mouseup',()=>{isPainting=false;lastP=null});pC.addEventListener('mouseleave',()=>{isPainting=false;lastP=null});pC.addEventListener('touchstart',e=>{e.preventDefault();isPainting=true;lastP=null;paintAt(e.touches[0].clientX,e.touches[0].clientY)},{passive:false});pC.addEventListener('touchmove',e=>{e.preventDefault();if(isPainting)paintAt(e.touches[0].clientX,e.touches[0].clientY)},{passive:false});pC.addEventListener('touchend',()=>{isPainting=false;lastP=null});document.querySelectorAll('.paint-color').forEach(el=>{el.addEventListener('click',()=>{document.querySelectorAll('.paint-color').forEach(c=>c.classList.remove('active'));el.classList.add('active');paintColor=el.dataset.color})});function clearPaint(){initPaint()}
const cC=document.getElementById('confetti'),cCtx=cC.getContext('2d'),conf=[];function initConf(){cC.width=W;cC.height=H}
function fireConfetti(){for(let i=0;i<80;i++)conf.push({x:cC.width/2+(Math.random()-.5)*200,y:cC.height*.55,vx:(Math.random()-.5)*10,vy:-5-Math.random()*7,r:2+Math.random()*4,hue:260+Math.random()*30,life:1,dec:.006+Math.random()*.008})}
function renderConf(){cCtx.clearRect(0,0,cC.width,cC.height);for(let i=conf.length-1;i>=0;i--){const c=conf[i];c.x+=c.vx;c.vy+=.08;c.y+=c.vy;c.life-=c.dec;if(c.life<=0){conf.splice(i,1);continue}
cCtx.save();cCtx.translate(c.x,c.y);cCtx.beginPath();const hs=c.r;cCtx.moveTo(0,hs*.3);cCtx.bezierCurveTo(-hs*.5,-hs*.1,-hs*.3,-hs*.55,0,-hs*.2);cCtx.bezierCurveTo(hs*.3,-hs*.55,hs*.5,-hs*.1,0,hs*.3);cCtx.closePath();cCtx.fillStyle='hsla('+c.hue+',45%,60%,'+c.life*.5+')';cCtx.fill();cCtx.restore()}}
function revealGift(el){el.querySelector('.gift-amount').classList.remove('gift-hidden');el.querySelector('.gift-amount').classList.add('gift-revealed');fireConfetti()}
document.querySelectorAll('[data-tilt]').forEach(el=>{el.addEventListener('mousemove',e=>{const r=el.getBoundingClientRect(),x=(e.clientX-r.left)/r.width-.5,y=(e.clientY-r.top)/r.height-.5;el.style.transform='perspective(800px) rotateY('+x*7+'deg) rotateX('+(-y*7)+'deg)'});el.addEventListener('mouseleave',()=>{el.style.transform=''})});
const obs=new IntersectionObserver(es=>{es.forEach(e=>{if(e.isIntersecting)e.target.classList.add('in-view')})},{threshold:.15});document.querySelectorAll('[data-reveal]').forEach(el=>obs.observe(el));
function openEnvelope(){document.getElementById('envWrap').classList.add('opening');setTimeout(()=>{document.getElementById('envelope').classList.add('opened');document.getElementById('cardContent').classList.add('visible')},800)}
function mainLoop(t){renderBg(t);_renderAtmos(bgCtx,t);_renderBurst(bgCtx);_renderT3(bgCtx,t);renderSR(t);renderConf();requestAnimationFrame(mainLoop)}
function init(){initBg();initSR();initPaint();initConf();requestAnimationFrame(mainLoop)}
window.addEventListener('resize',()=>{initBg();initSR();initConf()});init();
</script></body></html>
