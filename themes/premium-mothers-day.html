<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"><title>ðŸŒ· LiveCardStudio â€” Mother's Day</title><link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
<style>*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}html{scroll-behavior:smooth}body{font-family:'Cormorant Garamond',serif;background:#0a0812;color:#f0e0f0;overflow-x:hidden;-webkit-font-smoothing:antialiased}.envelope-screen{position:fixed;top:0;left:0;width:100%;height:100vh;z-index:1000;display:flex;align-items:center;justify-content:center;background:radial-gradient(ellipse at 50% 60%,#1a0e20 0%,#0a0812 60%);transition:opacity 1.2s ease,transform 1.2s ease}.envelope-screen.opened{opacity:0;pointer-events:none;transform:scale(1.05)}.envelope-wrap{position:relative;width:340px;height:230px;cursor:pointer;transform:translateY(20px);opacity:0;animation:ef 1.2s .3s cubic-bezier(.16,1,.3,1) forwards}@keyframes ef{to{transform:translateY(0);opacity:1}}.envelope-body{width:100%;height:100%;border-radius:14px;position:relative;background:linear-gradient(135deg,#1e1228,#140c1c);box-shadow:0 20px 60px rgba(0,0,0,.6);overflow:hidden}.envelope-flap{position:absolute;top:0;left:0;width:100%;height:55%;background:linear-gradient(180deg,#241430,#1a0e22);clip-path:polygon(0 0,50% 65%,100% 0);transform-origin:top center;transition:transform .8s cubic-bezier(.4,0,.2,1);z-index:2}.envelope-wrap.opening .envelope-flap{transform:rotateX(180deg)}.envelope-seal{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:64px;height:64px;border-radius:50%;z-index:3;background:radial-gradient(circle,#d4a0d0,#b870b0,#a060a0);box-shadow:0 0 30px rgba(180,100,170,.4);display:flex;align-items:center;justify-content:center;font-size:26px;animation:sg 3s ease-in-out infinite}@keyframes sg{0%,100%{box-shadow:0 0 25px rgba(180,100,170,.25)}50%{box-shadow:0 0 50px rgba(200,130,190,.55)}}.envelope-tagline{position:absolute;bottom:16px;left:0;right:0;text-align:center;font-style:italic;font-size:.78rem;color:rgba(200,150,190,.2);letter-spacing:.15em}canvas.bg{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;pointer-events:none}canvas.sr{position:fixed;top:0;left:0;width:100%;height:100%;z-index:1;pointer-events:none;opacity:.4}canvas.cc{position:fixed;top:0;left:0;width:100%;height:100%;z-index:40;pointer-events:none}.card-content{position:relative;z-index:5;opacity:0;transition:opacity 1.5s ease .5s;min-height:100vh}.card-content.visible{opacity:1}.hero-section{height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:40px 20px}.hero-occasion{font-size:.7rem;letter-spacing:.4em;text-transform:uppercase;color:rgba(200,150,190,.4);margin-bottom:16px;opacity:0;animation:fu 1s 1.5s ease forwards}.hero-name{font-family:'Playfair Display',serif;font-size:clamp(2.5rem,9vw,5.5rem);font-weight:700;line-height:1;background:linear-gradient(135deg,#e0a0d0,#c888c0,#d4a8cc,#f0c0e0);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:20px;opacity:0;animation:fu 1.2s 1.8s ease forwards}.hero-divider{width:100px;height:2px;margin:16px auto;background:linear-gradient(to right,transparent,rgba(200,130,190,.3),transparent);opacity:0;animation:fu 1s 2.3s ease forwards}.hero-subtitle{font-style:italic;font-size:1.3rem;color:rgba(200,160,190,.4);opacity:0;animation:fu 1s 2.5s ease forwards}@keyframes fu{to{opacity:1;transform:translateY(0)}}.scroll-hint{position:absolute;bottom:40px;left:50%;transform:translateX(-50%);opacity:0;animation:fu 1s 3s ease forwards;display:flex;flex-direction:column;align-items:center;gap:8px}.scroll-hint span{font-size:.65rem;letter-spacing:.2em;text-transform:uppercase;color:rgba(200,150,190,.15)}.scroll-arrow{width:20px;height:20px;border-right:1px solid rgba(200,150,190,.2);border-bottom:1px solid rgba(200,150,190,.2);transform:rotate(45deg);animation:sb 2s ease-in-out infinite}@keyframes sb{0%,100%{transform:rotate(45deg) translate(0,0);opacity:.2}50%{transform:rotate(45deg) translate(5px,5px);opacity:.5}}.photo-section{padding:80px 20px;max-width:900px;margin:0 auto;opacity:0;transform:translateY(60px);transition:all 1.2s cubic-bezier(.16,1,.3,1)}.photo-section.in-view{opacity:1;transform:translateY(0)}.photo-frame{position:relative;border-radius:16px;overflow:hidden;box-shadow:0 30px 80px rgba(0,0,0,.5);transition:transform .15s ease-out}.photo-frame img{width:100%;display:block}.photo-overlay{position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(180deg,transparent 60%,rgba(10,8,18,.85) 100%);pointer-events:none}.photo-duo{display:grid;grid-template-columns:1fr 1fr;gap:20px}.text-section{text-align:center;padding:60px 20px;max-width:700px;margin:0 auto;opacity:0;transform:translateY(40px);transition:all 1s cubic-bezier(.16,1,.3,1)}.text-section.in-view{opacity:1;transform:translateY(0)}.text-section p{font-size:1.4rem;line-height:1.9;color:rgba(230,200,220,.5);font-style:italic}.text-section .accent{color:#e0a0d0;font-weight:600}.sound-banner{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);z-index:50;padding:12px 28px;border-radius:40px;background:rgba(10,8,18,.9);border:1px solid rgba(200,130,190,.08);font-size:.8rem;letter-spacing:.15em;text-transform:uppercase;color:rgba(200,150,190,.4);cursor:pointer;display:flex;align-items:center;gap:10px;opacity:0;animation:fu .8s 3.5s ease forwards}.sound-bars{display:flex;gap:2px;align-items:end;height:14px}.sound-bar{width:3px;border-radius:2px;background:linear-gradient(to top,#a060a0,#d4a0d0);animation:sbr .8s ease-in-out infinite alternate}.sound-bar:nth-child(1){height:4px}.sound-bar:nth-child(2){height:8px;animation-delay:.15s}.sound-bar:nth-child(3){height:12px;animation-delay:.3s}.sound-bar:nth-child(4){height:6px;animation-delay:.45s}.sound-bars.paused .sound-bar{animation-play-state:paused;height:3px!important}@keyframes sbr{to{height:14px}}.paint-section{padding:80px 20px;text-align:center}.paint-prompt{font-size:1rem;color:rgba(200,150,190,.2);margin-bottom:20px}.paint-canvas-wrap{position:relative;max-width:800px;margin:0 auto;border-radius:16px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,.5)}.paint-canvas-wrap canvas{display:block;width:100%;cursor:crosshair;touch-action:none}.paint-tools{display:flex;justify-content:center;gap:10px;margin-top:16px}.paint-color{width:28px;height:28px;border-radius:50%;cursor:pointer;border:2px solid transparent;transition:all .3s}.paint-color.active{border-color:#fff;transform:scale(1.2)}.paint-clear{padding:6px 16px;border-radius:20px;border:1px solid rgba(200,130,190,.1);background:transparent;color:rgba(200,150,190,.35);font-family:'Cormorant Garamond',serif;font-size:.8rem;cursor:pointer}.message-section{padding:100px 20px;text-align:center;max-width:700px;margin:0 auto;opacity:0;transform:translateY(40px);transition:all 1.2s cubic-bezier(.16,1,.3,1)}.message-section.in-view{opacity:1;transform:translateY(0)}.msg-divider{width:60px;height:1px;margin:0 auto 30px;background:linear-gradient(to right,transparent,rgba(200,130,190,.3),transparent)}.msg-text{font-size:1.5rem;line-height:2;color:rgba(230,200,220,.55);font-style:italic;margin-bottom:40px}.msg-from{font-size:1rem;color:rgba(200,150,190,.3);letter-spacing:.15em}.gift-section{padding:80px 20px;text-align:center;opacity:0;transform:translateY(40px);transition:all 1s cubic-bezier(.16,1,.3,1)}.gift-section.in-view{opacity:1;transform:translateY(0)}.gift-card{display:inline-block;padding:40px 60px;border-radius:16px;background:rgba(20,12,24,.8);border:1px solid rgba(200,130,190,.06);cursor:pointer;transition:all .6s}.gift-card:hover{transform:translateY(-4px)}.gift-icon{font-size:2.5rem;margin-bottom:16px}.gift-label{font-size:.65rem;letter-spacing:.3em;text-transform:uppercase;color:rgba(200,150,190,.3);margin-bottom:12px}.gift-amount{font-family:'Playfair Display',serif;font-size:2.5rem;font-weight:700;background:linear-gradient(135deg,#e0a0d0,#c888c0);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.gift-hidden{filter:blur(20px);transition:filter .8s}.gift-revealed{filter:blur(0)}.lcs-footer{text-align:center;padding:60px 20px 40px;border-top:1px solid rgba(200,130,190,.04)}.lcs-made-with{font-style:italic;font-size:.75rem;color:rgba(200,150,190,.12);letter-spacing:.2em;text-transform:uppercase;margin-bottom:12px}.lcs-logo{font-family:'Playfair Display',serif;font-size:1.1rem;font-weight:700;color:#d4a0d0;text-decoration:none}.lcs-tagline{font-style:italic;font-size:.72rem;color:rgba(200,150,190,.08);margin-top:8px}@media(max-width:600px){.photo-duo{grid-template-columns:1fr}.hero-name{font-size:clamp(2rem,10vw,4rem)}.msg-text{font-size:1.2rem}}</style></head>
<body>
<div class="envelope-screen" id="envelope"><div class="envelope-wrap" id="envWrap" onclick="openEnvelope()"><div class="envelope-body"><div class="envelope-flap"></div><div class="envelope-seal">ðŸŒ·</div><div class="envelope-tagline">for the woman who gave me everything</div></div></div></div>
<canvas class="bg" id="bg"></canvas><canvas class="sr" id="sr"></canvas><canvas class="cc" id="confetti"></canvas>
<div class="sound-banner" onclick="toggleSound()"><div class="sound-bars" id="soundBars"><div class="sound-bar"></div><div class="sound-bar"></div><div class="sound-bar"></div><div class="sound-bar"></div></div><span id="soundLabel">lullaby</span></div>
<div class="card-content" id="cardContent">
  <section class="hero-section"><div class="hero-occasion">Happy Mother's Day</div><h1 class="hero-name">To the<br>Greatest Love<br>I Know</h1><div class="hero-divider"></div><div class="hero-subtitle">everything beautiful in me started with you</div><div class="scroll-hint"><span>for you, mom</span><div class="scroll-arrow"></div></div></section>
  <section class="photo-section" data-reveal><div class="photo-frame" data-tilt><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='900' height='600'%3E%3Crect fill='%23140c1c' width='900' height='600'/%3E%3Ctext x='450' y='300' text-anchor='middle' fill='rgba(200,150,190,.1)' font-family='serif' font-size='24'%3EYour Photo Here%3C/text%3E%3C/svg%3E" alt=""><div class="photo-overlay"></div></div></section>
  <section class="text-section" data-reveal><p>Before I could speak, you understood me. Before I could walk, you <span class="accent">carried me</span>. Before I knew what love was, you taught me.</p></section>
  <section class="photo-section" data-reveal><div class="photo-duo"><div class="photo-frame" data-tilt><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='533'%3E%3Crect fill='%23180e20' width='400' height='533'/%3E%3Ctext x='200' y='267' text-anchor='middle' fill='rgba(200,150,190,.1)' font-family='serif' font-size='18'%3EPhoto 2%3C/text%3E%3C/svg%3E" alt=""><div class="photo-overlay"></div></div><div class="photo-frame" data-tilt><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='533'%3E%3Crect fill='%23180e20' width='400' height='533'/%3E%3Ctext x='200' y='267' text-anchor='middle' fill='rgba(200,150,190,.1)' font-family='serif' font-size='18'%3EPhoto 3%3C/text%3E%3C/svg%3E" alt=""><div class="photo-overlay"></div></div></div></section>
  <section class="text-section" data-reveal><p>You are the <span class="accent">garden</span> that never stopped blooming, even in seasons that tried to break you. Your strength became my foundation.</p></section>
  <section class="paint-section" data-reveal><div class="paint-prompt">ðŸŒ· paint something for mama ðŸŒ·</div><div class="paint-canvas-wrap"><canvas id="paintCanvas" width="800" height="500"></canvas></div><div class="paint-tools"><div class="paint-color active" style="background:#d4a0d0" data-color="#d4a0d0"></div><div class="paint-color" style="background:#e0c0d8" data-color="#e0c0d8"></div><div class="paint-color" style="background:#a070a0" data-color="#a070a0"></div><div class="paint-color" style="background:#f0d8e8" data-color="#f0d8e8"></div><div class="paint-color" style="background:#80c090" data-color="#80c090"></div><button class="paint-clear" onclick="clearPaint()">clear</button></div></section>
  <section class="message-section" data-reveal><div class="msg-divider"></div><div class="msg-text">Mama, you are the first poem I ever memorized, the first song I ever sang back, the first hand I ever reached for. Everything I am is because you loved me first. Happy Mother's Day to my forever home.</div><div class="msg-from">â€” Your baby, forever and always ðŸŒ·</div></section>
  <section class="gift-section" data-reveal><div class="gift-card" onclick="revealGift(this)"><div class="gift-icon">ðŸŒ·</div><div class="gift-label">for you, mama</div><div class="gift-amount gift-hidden">$100</div></div></section>
  <footer class="lcs-footer"><div class="lcs-made-with">crafted on</div><a href="https://livecardstudio.com" class="lcs-logo">ðŸŒ· LiveCardStudio</a><div class="lcs-tagline">cards that live & breathe</div></footer>
</div>
<script>
const bgC=document.getElementById('bg'),bgCtx=bgC.getContext('2d');let W,H;
const gardenFlowers=[],petalRain=[],fireflies=[],vines=[],butterflies=[],moonGlow={},nebulaClouds=[],gardenBeds=[],hummingbirds=[];
const mothSilhouettes=[]; // Mother-child silhouettes

function drawTulip(ctx,x,y,s,phase,hue,a){
const sw=Math.sin(phase)*.08;ctx.save();ctx.translate(x,y);ctx.rotate(sw);
// Stem
ctx.strokeStyle='hsla(140,40%,35%,'+a+')';ctx.lineWidth=s*.08;ctx.beginPath();ctx.moveTo(0,0);ctx.quadraticCurveTo(s*.15,-s*.3,0,-s*.7);ctx.stroke();
// Leaves
ctx.fillStyle='hsla(135,45%,30%,'+(a*.8)+')';ctx.beginPath();ctx.moveTo(0,-s*.25);ctx.quadraticCurveTo(s*.25,-s*.4,s*.12,-s*.18);ctx.closePath();ctx.fill();
ctx.beginPath();ctx.moveTo(0,-s*.35);ctx.quadraticCurveTo(-s*.2,-s*.5,-s*.1,-s*.28);ctx.closePath();ctx.fill();
// Petals (5 overlapping)
const py=-s*.7;
[[-s*.15,0,'hsla('+hue+',55%,55%,'+a+')'],[s*.15,0,'hsla('+(hue+5)+',52%,52%,'+a+')'],[0,-s*.08,'hsla('+(hue+10)+',58%,58%,'+a+')'],[s*.08,s*.02,'hsla('+(hue+3)+',50%,50%,'+a+')'],[-s*.08,s*.02,'hsla('+(hue-3)+',53%,53%,'+a+')']].forEach(([dx,dy,c])=>{
ctx.beginPath();ctx.ellipse(dx,py+dy,s*.15,s*.22,dx*.5,0,Math.PI*2);ctx.fillStyle=c;ctx.fill()});
ctx.restore()}

function drawRose(ctx,x,y,s,phase,hue,a){
ctx.save();ctx.translate(x,y);ctx.rotate(Math.sin(phase)*.06);
// Stem + thorns
ctx.strokeStyle='hsla(130,35%,28%,'+a+')';ctx.lineWidth=s*.06;ctx.beginPath();ctx.moveTo(0,0);ctx.bezierCurveTo(-s*.08,-s*.2,s*.08,-s*.4,0,-s*.6);ctx.stroke();
// Leaf
ctx.fillStyle='hsla(130,40%,30%,'+(a*.7)+')';ctx.beginPath();ctx.ellipse(s*.12,-s*.2,s*.12,s*.06,.3,0,Math.PI*2);ctx.fill();
// Rose spiral petals
const cx=0,cy=-s*.6;for(let i=0;i<7;i++){const an=i*.9+phase*.1,r=s*(.04+i*.025);ctx.beginPath();ctx.arc(cx+Math.cos(an)*r*.3,cy+Math.sin(an)*r*.3,r,an,an+2.5);ctx.strokeStyle='hsla('+(hue+i*2)+',50%,'+(50+i*2)+'%,'+(a*(.9-i*.05))+')';ctx.lineWidth=s*(.04-.002*i);ctx.stroke()}
// Center
ctx.beginPath();ctx.arc(cx,cy,s*.06,0,Math.PI*2);ctx.fillStyle='hsla('+(hue+15)+',60%,60%,'+a+')';ctx.fill();ctx.restore()}

function drawDaisy(ctx,x,y,s,phase,a){
ctx.save();ctx.translate(x,y);ctx.rotate(Math.sin(phase)*.05);
ctx.strokeStyle='hsla(130,35%,30%,'+a+')';ctx.lineWidth=s*.05;ctx.beginPath();ctx.moveTo(0,0);ctx.lineTo(0,-s*.5);ctx.stroke();
for(let i=0;i<10;i++){const an=i*Math.PI/5+Math.sin(phase)*.03;ctx.beginPath();ctx.ellipse(Math.cos(an)*s*.18,-s*.5+Math.sin(an)*s*.18,s*.14,s*.05,an,0,Math.PI*2);ctx.fillStyle='rgba(255,255,240,'+(a*(.8-i*.02))+')';ctx.fill()}
ctx.beginPath();ctx.arc(0,-s*.5,s*.08,0,Math.PI*2);ctx.fillStyle='rgba(240,200,80,'+a+')';ctx.fill();ctx.restore()}

function drawLavender(ctx,x,y,s,phase,a){
ctx.save();ctx.translate(x,y);ctx.rotate(Math.sin(phase*.8)*.1);
ctx.strokeStyle='hsla(130,30%,35%,'+a+')';ctx.lineWidth=s*.04;ctx.beginPath();ctx.moveTo(0,0);ctx.quadraticCurveTo(s*.05,-s*.3,0,-s*.7);ctx.stroke();
for(let i=0;i<7;i++){const py=-s*.35-i*s*.05;const px=Math.sin(i*.6+phase*.2)*s*.03;
ctx.beginPath();ctx.ellipse(px-s*.04,py,s*.04,s*.025,-.3,0,Math.PI*2);ctx.fillStyle='hsla(270,45%,'+(50+i*2)+'%,'+(a*(.9-i*.05))+')';ctx.fill();
ctx.beginPath();ctx.ellipse(px+s*.04,py,s*.04,s*.025,.3,0,Math.PI*2);ctx.fillStyle='hsla(275,42%,'+(48+i*2)+'%,'+(a*(.85-i*.05))+')';ctx.fill()}
ctx.restore()}

function drawHummingbird(ctx,x,y,s,phase,hue,a){
ctx.save();ctx.translate(x,y);const wingF=Math.sin(phase*12)*.4;
ctx.fillStyle='hsla('+hue+',50%,50%,'+a+')';
// Body
ctx.beginPath();ctx.ellipse(0,0,s*.5,s*.15,-.2,0,Math.PI*2);ctx.fill();
// Head
ctx.beginPath();ctx.arc(s*.4,-s*.05,s*.12,0,Math.PI*2);ctx.fill();
// Beak
ctx.strokeStyle='hsla(30,30%,30%,'+a+')';ctx.lineWidth=1;ctx.beginPath();ctx.moveTo(s*.52,-s*.05);ctx.lineTo(s*.75,-s*.08);ctx.stroke();
// Wing
ctx.beginPath();ctx.ellipse(-s*.05,-s*.15,s*.35,s*.12+Math.abs(wingF)*s*.15,wingF,0,Math.PI*2);ctx.fillStyle='hsla('+(hue+20)+',45%,55%,'+(a*.7)+')';ctx.fill();
// Tail
ctx.beginPath();ctx.moveTo(-s*.45,0);ctx.lineTo(-s*.7,s*.1);ctx.lineTo(-s*.65,-s*.05);ctx.closePath();ctx.fillStyle='hsla('+(hue-10)+',40%,40%,'+a+')';ctx.fill();
// Eye
ctx.beginPath();ctx.arc(s*.45,-s*.07,s*.03,0,Math.PI*2);ctx.fillStyle='rgba(0,0,0,'+(a*.8)+')';ctx.fill();
// Iridescent throat
ctx.beginPath();ctx.arc(s*.3,s*.02,s*.08,0,Math.PI*2);const tg=ctx.createRadialGradient(s*.3,s*.02,0,s*.3,s*.02,s*.08);tg.addColorStop(0,'hsla('+(hue+60)+',70%,60%,'+(a*.6)+')');tg.addColorStop(1,'hsla('+hue+',50%,45%,'+(a*.3)+')');ctx.fillStyle=tg;ctx.fill();
ctx.restore()}

function drawMotherChild(ctx,x,y,s,a){
ctx.save();ctx.translate(x,y);
// Mother silhouette
ctx.fillStyle='rgba(180,130,170,'+a+')';
// Head
ctx.beginPath();ctx.arc(0,-s*.7,s*.12,0,Math.PI*2);ctx.fill();
// Hair flowing
ctx.beginPath();ctx.moveTo(-s*.1,-s*.75);ctx.quadraticCurveTo(-s*.25,-s*.65,-s*.2,-s*.5);ctx.quadraticCurveTo(-s*.18,-s*.6,-s*.12,-s*.65);ctx.closePath();ctx.fill();
// Body
ctx.beginPath();ctx.moveTo(-s*.08,-s*.58);ctx.quadraticCurveTo(-s*.2,-s*.3,-s*.15,0);ctx.lineTo(s*.15,0);ctx.quadraticCurveTo(s*.2,-s*.3,s*.08,-s*.58);ctx.closePath();ctx.fill();
// Arms cradling
ctx.beginPath();ctx.moveTo(s*.08,-s*.5);ctx.quadraticCurveTo(s*.25,-s*.35,s*.15,-s*.2);ctx.quadraticCurveTo(s*.05,-s*.15,-s*.1,-s*.2);ctx.strokeStyle='rgba(180,130,170,'+a+')';ctx.lineWidth=s*.06;ctx.stroke();
// Baby
ctx.fillStyle='rgba(220,180,210,'+(a*.8)+')';ctx.beginPath();ctx.arc(s*.05,-s*.25,s*.08,0,Math.PI*2);ctx.fill();ctx.beginPath();ctx.ellipse(s*.02,-s*.18,s*.06,s*.04,-.2,0,Math.PI*2);ctx.fill();
// Heart above
ctx.fillStyle='rgba(220,140,180,'+(a*.5)+')';ctx.beginPath();ctx.moveTo(0,-s*.88);const hs=s*.06;ctx.bezierCurveTo(-hs*.5,-s*.88-hs*.6,-hs*.35,-s*.88-hs*.2,0,-s*.88+hs*.3);ctx.bezierCurveTo(hs*.35,-s*.88-hs*.2,hs*.5,-s*.88-hs*.6,0,-s*.88);ctx.fill();
ctx.restore()}

function initBg(){W=bgC.width=window.innerWidth;H=bgC.height=window.innerHeight;
gardenFlowers.length=0;petalRain.length=0;fireflies.length=0;vines.length=0;butterflies.length=0;nebulaClouds.length=0;gardenBeds.length=0;hummingbirds.length=0;mothSilhouettes.length=0;
// Moon
moonGlow.x=W*.78;moonGlow.y=H*.15;moonGlow.r=25;
// Garden flowers
const types=['tulip','rose','daisy','lavender'];
for(let i=0;i<35;i++){const ty=types[i%4];gardenFlowers.push({x:W*(.03+Math.random()*.94),y:H*(.6+Math.random()*.25),s:12+Math.random()*22,type:ty,hue:ty==='tulip'?(300+Math.random()*40):ty==='rose'?(340+Math.random()*20):0,phase:Math.random()*Math.PI*2,phaseS:.001+Math.random()*.002,a:.06+Math.random()*.08})}
// Petal rain (soft falling petals)
for(let i=0;i<40;i++)petalRain.push({x:Math.random()*W,y:-Math.random()*H*1.5,s:2+Math.random()*5,rot:Math.random()*Math.PI*2,rotS:(Math.random()-.5)*.01,vy:.03+Math.random()*.08,vx:(Math.random()-.5)*.1,hue:300+Math.random()*50,a:.04+Math.random()*.06,sw:Math.random()*Math.PI*2});
// Fireflies
for(let i=0;i<30;i++)fireflies.push({x:Math.random()*W,y:H*(.35+Math.random()*.4),r:1+Math.random()*2.5,vx:(Math.random()-.5)*.2,vy:(Math.random()-.5)*.1,phase:Math.random()*Math.PI*2,a:.03+Math.random()*.05});
// Growing vines on edges
for(let i=0;i<4;i++)vines.push({x:i<2?W*(.02+Math.random()*.05):W*(.93+Math.random()*.05),startY:H*.9,segs:8+Math.floor(Math.random()*6),a:.04+Math.random()*.03,side:i<2?1:-1,phase:Math.random()*Math.PI*2});
// Butterflies
for(let i=0;i<6;i++)butterflies.push({x:Math.random()*W,y:H*(.25+Math.random()*.4),s:6+Math.random()*12,vx:(Math.random()-.5)*.25,vy:(Math.random()-.5)*.1,wP:Math.random()*Math.PI*2,wS:.02+Math.random()*.015,hue:280+Math.random()*60,a:.06+Math.random()*.06});
// Nebula clouds (soft purple/pink cosmic clouds)
for(let i=0;i<5;i++)nebulaClouds.push({x:W*(.1+Math.random()*.8),y:H*(.08+Math.random()*.3),rx:40+Math.random()*80,ry:20+Math.random()*40,hue:280+Math.random()*40,a:.01+Math.random()*.015,phase:Math.random()*Math.PI*2});
// Hummingbirds
for(let i=0;i<3;i++)hummingbirds.push({x:Math.random()*W,y:H*(.3+Math.random()*.25),s:10+Math.random()*10,vx:.15+Math.random()*.3,vy:(Math.random()-.5)*.1,hue:160+Math.random()*100,a:.07+Math.random()*.06,phase:Math.random()*Math.PI*2});
// Mother-child silhouettes
for(let i=0;i<2;i++)mothSilhouettes.push({x:W*(.25+i*.5),y:H*(.55+Math.random()*.05),s:25+Math.random()*20,a:.025+Math.random()*.015,bob:Math.random()*Math.PI*2})}

function renderBg(t){const g=bgCtx.createRadialGradient(W*.5,H*.4,0,W*.5,H*.5,W*.6);g.addColorStop(0,'#120a18');g.addColorStop(.4,'#0e0814');g.addColorStop(.7,'#0a0610');g.addColorStop(1,'#060408');bgCtx.fillStyle=g;bgCtx.fillRect(0,0,W,H);const sY=window.scrollY||0;
bgCtx.globalCompositeOperation='screen';
// Nebula clouds
nebulaClouds.forEach(nc=>{const pulse=Math.sin(t*.0005+nc.phase)*.3+.7;const ng=bgCtx.createRadialGradient(nc.x,nc.y-sY*.02,0,nc.x,nc.y-sY*.02,nc.rx);
ng.addColorStop(0,'hsla('+nc.hue+',40%,40%,'+(nc.a*pulse)+')');ng.addColorStop(.5,'hsla('+(nc.hue+15)+',35%,30%,'+(nc.a*.4*pulse)+')');ng.addColorStop(1,'hsla('+nc.hue+',30%,20%,0)');bgCtx.fillStyle=ng;bgCtx.beginPath();bgCtx.ellipse(nc.x,nc.y-sY*.02,nc.rx,nc.ry,0,0,Math.PI*2);bgCtx.fill()});
// Moon with halo
const my=moonGlow.y-sY*.03;const mg=bgCtx.createRadialGradient(moonGlow.x,my,0,moonGlow.x,my,moonGlow.r*5);
mg.addColorStop(0,'rgba(240,220,240,.08)');mg.addColorStop(.2,'rgba(200,180,210,.04)');mg.addColorStop(.5,'rgba(160,140,180,.01)');mg.addColorStop(1,'rgba(120,100,140,0)');bgCtx.fillStyle=mg;bgCtx.beginPath();bgCtx.arc(moonGlow.x,my,moonGlow.r*5,0,Math.PI*2);bgCtx.fill();
bgCtx.beginPath();bgCtx.arc(moonGlow.x,my,moonGlow.r,0,Math.PI*2);bgCtx.fillStyle='rgba(235,225,240,.06)';bgCtx.fill();
// Stars
for(let i=0;i<80;i++){const sx2=(i*137.5)%W,sy2=((i*97.3)%(.5*H))-sY*.01;const twinkle=Math.sin(t*.002+i*1.7)*.3+.7;bgCtx.beginPath();bgCtx.arc(sx2,sy2,(.5+Math.random())*twinkle,0,Math.PI*2);bgCtx.fillStyle='rgba(220,200,230,'+(0.02+twinkle*.03)+')';bgCtx.fill()}
// Vines
vines.forEach(v=>{let cx=v.x,cy=v.startY-sY*.04;const segH=25;bgCtx.strokeStyle='hsla(130,35%,25%,'+v.a+')';bgCtx.lineWidth=2;bgCtx.lineCap='round';
for(let s=0;s<v.segs;s++){const nx=cx+v.side*(5+Math.sin(t*.001+v.phase+s*.8)*8);const ny=cy-segH;bgCtx.beginPath();bgCtx.moveTo(cx,cy);bgCtx.quadraticCurveTo(cx+v.side*12,cy-segH*.5,nx,ny);bgCtx.stroke();
if(s%2===0){bgCtx.fillStyle='hsla(130,40%,28%,'+(v.a*.7)+')';bgCtx.beginPath();bgCtx.ellipse(nx+v.side*5,ny,6,3,.3*v.side,0,Math.PI*2);bgCtx.fill();bgCtx.beginPath();bgCtx.ellipse(nx+v.side*3,ny+5,5,2.5,-.2*v.side,0,Math.PI*2);bgCtx.fill()}
if(s%3===0){bgCtx.fillStyle='hsla(310,40%,50%,'+(v.a*.5)+')';bgCtx.beginPath();bgCtx.arc(nx,ny-3,2.5,0,Math.PI*2);bgCtx.fill()}
cx=nx;cy=ny}});
// Garden flowers
gardenFlowers.forEach(fl=>{fl.phase+=fl.phaseS;const fy=fl.y-sY*.05;
if(fl.type==='tulip')drawTulip(bgCtx,fl.x,fy,fl.s,fl.phase,fl.hue,fl.a);else if(fl.type==='rose')drawRose(bgCtx,fl.x,fy,fl.s,fl.phase,fl.hue,fl.a);else if(fl.type==='daisy')drawDaisy(bgCtx,fl.x,fy,fl.s,fl.phase,fl.a);else drawLavender(bgCtx,fl.x,fy,fl.s,fl.phase,fl.a)});
// Butterflies
butterflies.forEach(bf=>{bf.x+=bf.vx+Math.sin(t*.001+bf.wP)*.3;bf.y+=bf.vy+Math.cos(t*.0008+bf.wP)*.15;if(bf.x<-20)bf.x=W+20;if(bf.x>W+20)bf.x=-20;if(bf.y<H*.15)bf.vy=Math.abs(bf.vy);if(bf.y>H*.65)bf.vy=-Math.abs(bf.vy);
const wingF=Math.sin(t*bf.wS+bf.wP);
bgCtx.save();bgCtx.translate(bf.x,bf.y-sY*.05);
[[-1,1],[1,1],[-1,-1],[1,-1]].forEach(([dx,dy],ii)=>{const ws=ii<2?bf.s:bf.s*.65;bgCtx.beginPath();bgCtx.moveTo(0,0);bgCtx.quadraticCurveTo(dx*ws*Math.abs(wingF),dy*(-ws*.4),dx*ws*.5*Math.abs(wingF),dy*ws*.25);bgCtx.quadraticCurveTo(dx*ws*.15*Math.abs(wingF),dy*ws*.3,0,bf.s*.06*dy);bgCtx.closePath();bgCtx.fillStyle='hsla('+bf.hue+',40%,'+(50+ii*4)+'%,'+bf.a+')';bgCtx.fill()});
bgCtx.beginPath();bgCtx.ellipse(0,0,bf.s*.05,bf.s*.2,0,0,Math.PI*2);bgCtx.fillStyle='hsla('+bf.hue+',30%,40%,'+bf.a+')';bgCtx.fill();bgCtx.restore()});
// Hummingbirds
hummingbirds.forEach(hb=>{hb.x+=hb.vx;hb.y+=hb.vy+Math.sin(t*.002+hb.phase)*.2;hb.phase+=.05;if(hb.x>W+30){hb.x=-30;hb.y=H*(.3+Math.random()*.25)}
drawHummingbird(bgCtx,hb.x,hb.y-sY*.05,hb.s,hb.phase,hb.hue,hb.a)});
// Petal rain
petalRain.forEach(p=>{p.y+=p.vy;p.x+=p.vx+Math.sin(t*.001+p.sw)*.15;p.rot+=p.rotS;if(p.y>H+10){p.y=-10;p.x=Math.random()*W}
bgCtx.save();bgCtx.translate(p.x,p.y-sY*.03);bgCtx.rotate(p.rot);bgCtx.beginPath();bgCtx.ellipse(0,0,p.s,p.s*.4,.3,0,Math.PI*2);bgCtx.fillStyle='hsla('+p.hue+',45%,60%,'+p.a+')';bgCtx.fill();bgCtx.restore()});
// Fireflies
fireflies.forEach(ff=>{ff.x+=ff.vx+Math.sin(t*.001+ff.phase)*.15;ff.y+=ff.vy+Math.cos(t*.0008+ff.phase)*.1;
if(ff.x<0)ff.x=W;if(ff.x>W)ff.x=0;if(ff.y<H*.3)ff.vy=Math.abs(ff.vy);if(ff.y>H*.75)ff.vy=-Math.abs(ff.vy);
const pulse=Math.sin(t*.003+ff.phase)*.4+.6;const fg=bgCtx.createRadialGradient(ff.x,ff.y-sY*.04,0,ff.x,ff.y-sY*.04,ff.r*4);
fg.addColorStop(0,'rgba(220,200,100,'+(ff.a*pulse)+')');fg.addColorStop(.5,'rgba(200,180,80,'+(ff.a*.3*pulse)+')');fg.addColorStop(1,'rgba(180,160,60,0)');
bgCtx.fillStyle=fg;bgCtx.beginPath();bgCtx.arc(ff.x,ff.y-sY*.04,ff.r*4,0,Math.PI*2);bgCtx.fill();
bgCtx.beginPath();bgCtx.arc(ff.x,ff.y-sY*.04,ff.r*pulse,0,Math.PI*2);bgCtx.fillStyle='rgba(240,230,140,'+(ff.a*1.5*pulse)+')';bgCtx.fill()});
// Mother-child silhouettes
mothSilhouettes.forEach(ms=>{const bob=Math.sin(t*.001+ms.bob)*.5;drawMotherChild(bgCtx,ms.x,ms.y+bob-sY*.05,ms.s,ms.a)});
// Ground/garden bed gradient
const gbg=bgCtx.createLinearGradient(0,H*.75-sY*.04,0,H);gbg.addColorStop(0,'rgba(15,25,10,0)');gbg.addColorStop(.5,'rgba(15,25,10,.02)');gbg.addColorStop(1,'rgba(10,18,8,.03)');bgCtx.fillStyle=gbg;bgCtx.fillRect(0,H*.75-sY*.04,W,H*.25);
_renderAtmos(bgCtx,t);_renderBurst(bgCtx);_renderT3(bgCtx,t);_renderLA(bgCtx,t);bgCtx.globalCompositeOperation='source-over'}

let audioCtx,analyser,analyserData,soundPlaying=false;
function initAudio(){audioCtx=new(window.AudioContext||window.webkitAudioContext)();analyser=audioCtx.createAnalyser();analyser.fftSize=256;analyserData=new Uint8Array(analyser.frequencyBinCount);const m=audioCtx.createGain();m.gain.value=.15;m.connect(analyser);analyser.connect(audioCtx.destination);
// Warm lullaby pad
[261.63,329.63,392,523.25].forEach((f,i)=>{const o=audioCtx.createOscillator();o.type=i%2?'triangle':'sine';o.frequency.value=f;const g=audioCtx.createGain();g.gain.value=.012;const lfo=audioCtx.createOscillator();lfo.type='sine';lfo.frequency.value=.03+i*.008;const lg=audioCtx.createGain();lg.gain.value=.004;lfo.connect(lg);lg.connect(g.gain);lfo.start();o.connect(g);g.connect(m);o.start()});
// Gentle melody (Twinkle Twinkle/lullaby)
const lullaby=[261.63,261.63,392,392,440,440,392,0,349.23,349.23,329.63,329.63,293.66,293.66,261.63];let li=0;
function playNote(){if(!soundPlaying)return;setTimeout(()=>{if(!soundPlaying)return;const f=lullaby[li%lullaby.length];li++;if(f>0){const o=audioCtx.createOscillator();o.type='sine';o.frequency.value=f;const g=audioCtx.createGain();g.gain.setValueAtTime(.02,audioCtx.currentTime);g.gain.exponentialRampToValueAtTime(.001,audioCtx.currentTime+1.8);const f2=audioCtx.createBiquadFilter();f2.type='lowpass';f2.frequency.value=800;o.connect(f2);f2.connect(g);g.connect(m);o.start();o.stop(audioCtx.currentTime+2)}playNote()},1200+Math.random()*200)}playNote();
// Crickets
function cricket(){if(!soundPlaying)return;setTimeout(()=>{if(!soundPlaying)return;const f=4000+Math.random()*2000;const o=audioCtx.createOscillator();o.type='sine';o.frequency.value=f;const g=audioCtx.createGain();const now=audioCtx.currentTime;for(let c=0;c<6;c++){g.gain.setValueAtTime(.008,now+c*.06);g.gain.linearRampToValueAtTime(0,now+c*.06+.03)}o.connect(g);g.connect(m);o.start();o.stop(now+.4);cricket()},(2+Math.random()*4)*1000)}cricket()}
function toggleSound(){if(!soundPlaying){if(!audioCtx)initAudio();else audioCtx.resume();soundPlaying=true;document.getElementById('soundBars').classList.remove('paused');document.getElementById('soundLabel').textContent='lullaby'}else{audioCtx.suspend();soundPlaying=false;document.getElementById('soundBars').classList.add('paused');document.getElementById('soundLabel').textContent='lullaby'}}
const srC=document.getElementById('sr'),srCtx=srC.getContext('2d');function initSR(){srC.width=W;srC.height=H}
function renderSR(t){srCtx.clearRect(0,0,srC.width,srC.height);if(!soundPlaying||!analyser)return;analyser.getByteFrequencyData(analyserData);const bass=analyserData.slice(0,4).reduce((a,b)=>a+b,0)/(4*255);srCtx.globalCompositeOperation='screen';
const sg2=srCtx.createRadialGradient(srC.width/2,srC.height*.6,0,srC.width/2,srC.height*.6,bass*350);sg2.addColorStop(0,'rgba(200,140,200,'+(bass*.08)+')');sg2.addColorStop(.5,'rgba(160,100,160,'+(bass*.03)+')');sg2.addColorStop(1,'rgba(120,70,120,0)');srCtx.fillStyle=sg2;srCtx.fillRect(0,0,srC.width,srC.height);srCtx.globalCompositeOperation='source-over'}
const pC=document.getElementById('paintCanvas'),pCtx=pC.getContext('2d');let paintColor='#d4a0d0',isPainting=false,lastP=null;function initPaint(){pCtx.fillStyle='#0e0814';pCtx.fillRect(0,0,800,500)}function paintAt(x,y){const r=pC.getBoundingClientRect(),px=(x-r.left)*(800/r.width),py=(y-r.top)*(500/r.height);if(lastP){pCtx.beginPath();pCtx.moveTo(lastP.x,lastP.y);pCtx.lineTo(px,py);pCtx.strokeStyle=paintColor;pCtx.lineWidth=4;pCtx.lineCap='round';pCtx.globalAlpha=.45;pCtx.stroke();pCtx.globalAlpha=1}lastP={x:px,y:py}}pC.addEventListener('mousedown',e=>{isPainting=true;lastP=null;paintAt(e.clientX,e.clientY)});pC.addEventListener('mousemove',e=>{if(isPainting)paintAt(e.clientX,e.clientY)});pC.addEventListener('mouseup',()=>{isPainting=false;lastP=null});pC.addEventListener('mouseleave',()=>{isPainting=false;lastP=null});pC.addEventListener('touchstart',e=>{e.preventDefault();isPainting=true;lastP=null;paintAt(e.touches[0].clientX,e.touches[0].clientY)},{passive:false});pC.addEventListener('touchmove',e=>{e.preventDefault();if(isPainting)paintAt(e.touches[0].clientX,e.touches[0].clientY)},{passive:false});pC.addEventListener('touchend',()=>{isPainting=false;lastP=null});document.querySelectorAll('.paint-color').forEach(el=>{el.addEventListener('click',()=>{document.querySelectorAll('.paint-color').forEach(c=>c.classList.remove('active'));el.classList.add('active');paintColor=el.dataset.color})});function clearPaint(){initPaint()}
const cC=document.getElementById('confetti'),cCtx=cC.getContext('2d'),conf=[];function initConf(){cC.width=W;cC.height=H}function fireConfetti(){for(let i=0;i<80;i++)conf.push({x:cC.width/2+(Math.random()-.5)*200,y:cC.height*.55,vx:(Math.random()-.5)*10,vy:-5-Math.random()*7,s:3+Math.random()*6,hue:290+Math.random()*50,rot:Math.random()*Math.PI*2,rotS:(Math.random()-.5)*.15,life:1,dec:.005+Math.random()*.008,tp:Math.random()})}
function renderConf(){cCtx.clearRect(0,0,cC.width,cC.height);for(let i=conf.length-1;i>=0;i--){const c2=conf[i];c2.x+=c2.vx;c2.vy+=.1;c2.y+=c2.vy;c2.rot+=c2.rotS;c2.life-=c2.dec;if(c2.life<=0){conf.splice(i,1);continue}
cCtx.save();cCtx.translate(c2.x,c2.y);cCtx.rotate(c2.rot);if(c2.tp>.6){cCtx.beginPath();cCtx.ellipse(0,0,c2.s,c2.s*.4,.3,0,Math.PI*2);cCtx.fillStyle='hsla('+c2.hue+',50%,60%,'+c2.life*.5+')';cCtx.fill()}else{cCtx.fillStyle='hsla('+c2.hue+',45%,55%,'+c2.life*.4+')';cCtx.beginPath();const hs=c2.s*.5;cCtx.moveTo(0,hs*.35);cCtx.bezierCurveTo(-hs*.55,-hs*.15,-hs*.35,-hs*.65,0,-hs*.22);cCtx.bezierCurveTo(hs*.35,-hs*.65,hs*.55,-hs*.15,0,hs*.35);cCtx.closePath();cCtx.fill()}cCtx.restore()}}
function revealGift(el){el.querySelector('.gift-amount').classList.remove('gift-hidden');el.querySelector('.gift-amount').classList.add('gift-revealed');fireConfetti()}
document.querySelectorAll('[data-tilt]').forEach(el=>{el.addEventListener('mousemove',e=>{const r=el.getBoundingClientRect(),x=(e.clientX-r.left)/r.width-.5,y=(e.clientY-r.top)/r.height-.5;el.style.transform='perspective(800px) rotateY('+x*7+'deg) rotateX('+(-y*7)+'deg)'});el.addEventListener('mouseleave',()=>{el.style.transform='perspective(800px) rotateX(0) rotateY(0)'})});
const obs=new IntersectionObserver(es=>{es.forEach(e=>{if(e.isIntersecting)e.target.classList.add('in-view')})},{threshold:.15});document.querySelectorAll('[data-reveal]').forEach(el=>obs.observe(el));
function openEnvelope(){document.getElementById('envWrap').classList.add('opening');setTimeout(()=>{document.getElementById('envelope').classList.add('opened');document.getElementById('cardContent').classList.add('visible')},800)}


// === SIMPLEX NOISE ENGINE ===
const _SN=(()=>{const p=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];
const perm=new Uint8Array(512),permMod12=new Uint8Array(512);
for(let i=0;i<512;i++){perm[i]=p[i&255];permMod12[i]=perm[i]%12}
const G2=(3-Math.sqrt(3))/6,G3=1/6;
const grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]];
function dot2(g,x,y){return g[0]*x+g[1]*y}
function dot3(g,x,y,z){return g[0]*x+g[1]*y+g[2]*z}
return{
noise2D(x,y){const s=(x+y)*.5*(Math.sqrt(3)-1),i=Math.floor(x+s),j=Math.floor(y+s),tt=(i+j)*G2,X0=i-tt,Y0=j-tt,x0=x-X0,y0=y-Y0;
let i1,j1;if(x0>y0){i1=1;j1=0}else{i1=0;j1=1}
const x1=x0-i1+G2,y1=y0-j1+G2,x2=x0-1+2*G2,y2=y0-1+2*G2,ii=i&255,jj=j&255;
let n0=0,n1=0,n2=0,t0=.5-x0*x0-y0*y0;if(t0>=0){t0*=t0;n0=t0*t0*dot2(grad3[permMod12[ii+perm[jj]]],x0,y0)}
let t1=.5-x1*x1-y1*y1;if(t1>=0){t1*=t1;n1=t1*t1*dot2(grad3[permMod12[ii+i1+perm[jj+j1]]],x1,y1)}
let t2=.5-x2*x2-y2*y2;if(t2>=0){t2*=t2;n2=t2*t2*dot2(grad3[permMod12[ii+1+perm[jj+1]]],x2,y2)}
return 70*(n0+n1+n2)},
noise3D(x,y,z){const s=(x+y+z)/3,i=Math.floor(x+s),j=Math.floor(y+s),k=Math.floor(z+s),tt=(i+j+k)*G3,X0=i-tt,Y0=j-tt,Z0=k-tt,x0=x-X0,y0=y-Y0,z0=z-Z0;
let i1,j1,k1,i2,j2,k2;if(x0>=y0){if(y0>=z0){i1=1;j1=0;k1=0;i2=1;j2=1;k2=0}else if(x0>=z0){i1=1;j1=0;k1=0;i2=1;j2=0;k2=1}else{i1=0;j1=0;k1=1;i2=1;j2=0;k2=1}}else{if(y0<z0){i1=0;j1=0;k1=1;i2=0;j2=1;k2=1}else if(x0<z0){i1=0;j1=1;k1=0;i2=0;j2=1;k2=1}else{i1=0;j1=1;k1=0;i2=1;j2=1;k2=0}}
const x1=x0-i1+G3,y1=y0-j1+G3,z1=z0-k1+G3,x2=x0-i2+2*G3,y2=y0-j2+2*G3,z2=z0-k2+2*G3,x3=x0-1+3*G3,y3=y0-1+3*G3,z3=z0-1+3*G3;
const ii=i&255,jj=j&255,kk=k&255;let n0=0,n1=0,n2=0,n3=0;
let t0=.6-x0*x0-y0*y0-z0*z0;if(t0>=0){t0*=t0;n0=t0*t0*dot3(grad3[permMod12[ii+perm[jj+perm[kk]]]],x0,y0,z0)}
let t1=.6-x1*x1-y1*y1-z1*z1;if(t1>=0){t1*=t1;n1=t1*t1*dot3(grad3[permMod12[ii+i1+perm[jj+j1+perm[kk+k1]]]],x1,y1,z1)}
let t2=.6-x2*x2-y2*y2-z2*z2;if(t2>=0){t2*=t2;n2=t2*t2*dot3(grad3[permMod12[ii+i2+perm[jj+j2+perm[kk+k2]]]],x2,y2,z2)}
let t3=.6-x3*x3-y3*y3-z3*z3;if(t3>=0){t3*=t3;n3=t3*t3*dot3(grad3[permMod12[ii+1+perm[jj+1+perm[kk+1]]]],x3,y3,z3)}
return 32*(n0+n1+n2+n3)}
}})();



// === ANIMATED SHIMMER + VIGNETTE + DOUBLE-TAP EGG ===
let _shimPhase=0;
const _eggP=[];let _lastTap=0;
function _onDoubleTap(ex,ey){const now=Date.now();if(now-_lastTap<350){for(let i=0;i<40;i++){const ang=(i/40)*Math.PI*2;const spd=1+Math.random()*4;const delay=Math.random()*12;_eggP.push({x:ex,y:ey,vx:Math.cos(ang)*spd,vy:Math.sin(ang)*spd,sz:2+Math.random()*4,l:1,d:.003+Math.random()*.005,h:300+Math.random()*30-30/2,delay:delay,born:0})}}
_lastTap=now}
document.addEventListener('click',e=>_onDoubleTap(e.clientX,e.clientY));
document.addEventListener('touchend',e=>{if(e.changedTouches&&e.changedTouches.length)_onDoubleTap(e.changedTouches[0].clientX,e.changedTouches[0].clientY)},{passive:true});
function _renderT3(ctx,t){
// Breathing vignette
_shimPhase+=.008;const vigA=.03+Math.sin(_shimPhase)*.015;
const vig=ctx.createRadialGradient(W/2,H/2,W*.2,W/2,H/2,W*.7);vig.addColorStop(0,'rgba(0,0,0,0)');vig.addColorStop(.7,'rgba(35,25,50,'+(vigA*.5)+')');vig.addColorStop(1,'rgba(35,25,50,'+vigA+')');ctx.fillStyle=vig;ctx.fillRect(0,0,W,H);
// Shimmer spotlight (drifting radial glow)
const sx=W/2+_SN.noise2D(_shimPhase*.3,0)*W*.25;const sy=H/2+_SN.noise2D(0,_shimPhase*.3)*H*.2;
const sg=ctx.createRadialGradient(sx,sy,0,sx,sy,W*.15);sg.addColorStop(0,'rgba(180,140,200,.018)');sg.addColorStop(.5,'rgba(180,140,200,.008)');sg.addColorStop(1,'rgba(180,140,200,0)');ctx.fillStyle=sg;ctx.fillRect(0,0,W,H);
// Double-tap egg particles
for(let i=_eggP.length-1;i>=0;i--){const ep=_eggP[i];ep.born++;if(ep.born<ep.delay)continue;
ep.x+=ep.vx;ep.y+=ep.vy;ep.vx*=.985;ep.vy*=.985;ep.vy+=.015;ep.l-=ep.d;if(ep.l<=0){_eggP.splice(i,1);continue}
const ea=ep.l*.6;ctx.beginPath();ctx.arc(ep.x,ep.y,ep.sz*ep.l,0,Math.PI*2);ctx.fillStyle='hsla('+ep.h+',70%,60%,'+ea+')';ctx.fill();
const eg=ctx.createRadialGradient(ep.x,ep.y,0,ep.x,ep.y,ep.sz*3);eg.addColorStop(0,'hsla('+ep.h+',60%,65%,'+(ea*.15)+')');eg.addColorStop(1,'hsla('+ep.h+',50%,55%,0)');ctx.fillStyle=eg;ctx.beginPath();ctx.arc(ep.x,ep.y,ep.sz*3,0,Math.PI*2);ctx.fill()}
}

// === TAP BURST SYSTEM ===
const _BP=[];
function _onTapBurst(ex,ey){for(let i=0;i<16;i++){const ang=Math.random()*Math.PI*2;const spd=.5+Math.random()*2;_BP.push({x:ex,y:ey,vx:Math.cos(ang)*spd,vy:Math.sin(ang)*spd,sz:1+Math.random()*3,l:1,d:.008+Math.random()*.012,h:300+Math.random()*30-30*.5})}}
document.addEventListener('click',e=>_onTapBurst(e.clientX,e.clientY));
document.addEventListener('touchstart',e=>{if(e.touches.length)_onTapBurst(e.touches[0].clientX,e.touches[0].clientY)},{passive:true});
function _renderBurst(ctx){for(let i=_BP.length-1;i>=0;i--){const bp=_BP[i];bp.x+=bp.vx;bp.y+=bp.vy;bp.vx*=.97;bp.vy*=.97;bp.vy+=.02;bp.l-=bp.d;if(bp.l<=0){_BP.splice(i,1);continue}
ctx.beginPath();ctx.arc(bp.x,bp.y,bp.sz*bp.l,0,Math.PI*2);ctx.fillStyle='hsla('+bp.h+',65%,60%,'+(bp.l*.5)+')';ctx.fill();
const bg=ctx.createRadialGradient(bp.x,bp.y,0,bp.x,bp.y,bp.sz*5);bg.addColorStop(0,'hsla('+bp.h+',60%,60%,'+(bp.l*.08)+')');bg.addColorStop(1,'hsla('+bp.h+',50%,50%,0)');ctx.fillStyle=bg;ctx.beginPath();ctx.arc(bp.x,bp.y,bp.sz*5,0,Math.PI*2);ctx.fill();
}}

// === NOISE FLOW FIELD ATMOSPHERE ===
const _FF={res:25,cols:0,rows:0,field:[],zOff:0};
const _AP=[];const _AP_MAX=80;
function _initFF(){_FF.cols=Math.ceil(W/_FF.res);_FF.rows=Math.ceil(H/_FF.res);_FF.field=new Float32Array(_FF.cols*_FF.rows)}
function _updateFF(t){_FF.zOff+=.0008;for(let r=0;r<_FF.rows;r++)for(let c=0;c<_FF.cols;c++){_FF.field[r*_FF.cols+c]=_SN.noise3D(c*.06,r*.06,_FF.zOff)*Math.PI*4}}
function _getAngle(x,y){const c=Math.floor(x/_FF.res),r=Math.floor(y/_FF.res);if(c<0||c>=_FF.cols||r<0||r>=_FF.rows)return 0;return _FF.field[r*_FF.cols+c]}
function _spawnAP(){while(_AP.length<_AP_MAX)_AP.push({x:Math.random()*W,y:Math.random()*H,px:0,py:0,vx:0,vy:0,life:1,maxL:200+Math.random()*400,age:0,hShift:Math.random()*30,sz:.5+Math.random()*1.5})}
function _renderAtmos(ctx,t){_updateFF(t);
const pulse=.85+Math.sin(t*.0004)*.15;
for(let i=_AP.length-1;i>=0;i--){const p=_AP[i];p.px=p.x;p.py=p.y;
const a=_getAngle(p.x,p.y);p.vx+=Math.cos(a)*0.15;p.vy+=Math.sin(a)*0.15;
// Mouse interaction
if(_mA){const dx=_mX-p.x,dy=_mY-p.y,d=Math.sqrt(dx*dx+dy*dy);if(d<150&&d>0){const f=(1-d/150)*0.08;p.vx+=(dx/d)*f;p.vy+=(dy/d)*f}}
p.vx*=.96;p.vy*=.96;const spd=Math.sqrt(p.vx*p.vx+p.vy*p.vy);if(spd>3){p.vx=(p.vx/spd)*3;p.vy=(p.vy/spd)*3}
p.x+=p.vx;p.y+=p.vy;p.age++;p.life=1-p.age/p.maxL;
if(p.x<-10)p.x=W+10;if(p.x>W+10)p.x=-10;if(p.y<-10)p.y=H+10;if(p.y>H+10)p.y=-10;
if(p.life<=0){p.x=Math.random()*W;p.y=Math.random()*H;p.px=p.x;p.py=p.y;p.vx=0;p.vy=0;p.life=1;p.age=0;p.maxL=200+Math.random()*400;continue}
// Draw with trail
const al=p.life*0.15*pulse;const h=(300+p.hShift+_gHue)%360;
ctx.strokeStyle='hsla('+h+',45%,65%,'+al+')';ctx.lineWidth=p.sz*p.life;ctx.beginPath();ctx.moveTo(p.px,p.py);ctx.lineTo(p.x,p.y);ctx.stroke();
// Glow dot
if(p.sz>1){ctx.beginPath();ctx.arc(p.x,p.y,p.sz*p.life*.8,0,Math.PI*2);ctx.fillStyle='hsla('+h+',45%,80%,'+(al*.4)+')';ctx.fill()}
}}
_initFF();_spawnAP();

// === LIVING ART ENHANCEMENTS ===
let _mX=0,_mY=0,_mA=false;const _ct=[];let _gHue=0,_rT=0;const _rP=[];
document.addEventListener('mousemove',e=>{_mX=e.clientX;_mY=e.clientY;_mA=true;if(_ct.length<25)_ct.push({x:e.clientX,y:e.clientY,r:1+Math.random()*3,l:1,d:.015+Math.random()*.01})});
document.addEventListener('touchmove',e=>{_mX=e.touches[0].clientX;_mY=e.touches[0].clientY;_mA=true;if(_ct.length<15)_ct.push({x:e.touches[0].clientX,y:e.touches[0].clientY,r:1+Math.random()*3,l:1,d:.015+Math.random()*.01})},{passive:true});
document.addEventListener('mouseleave',()=>{_mA=false});
function _renderLA(ctx,t){_gHue=Math.sin(t*.00003)*25;
for(let i=_ct.length-1;i>=0;i--){const p=_ct[i];p.l-=p.d;p.r*=.98;p.y+=.2;if(p.l<=0){_ct.splice(i,1);continue}
ctx.beginPath();ctx.arc(p.x,p.y,p.r*p.l,0,Math.PI*2);ctx.fillStyle='rgba(200,180,220,'+(p.l*.3)+')';ctx.fill();
const tg=ctx.createRadialGradient(p.x,p.y,0,p.x,p.y,p.r*3);tg.addColorStop(0,'rgba(200,180,220,'+(p.l*.08)+')');tg.addColorStop(1,'rgba(200,180,220,0)');ctx.fillStyle=tg;ctx.beginPath();ctx.arc(p.x,p.y,p.r*3,0,Math.PI*2);ctx.fill()}
if(_mA){const mg=ctx.createRadialGradient(_mX,_mY,0,_mX,_mY,80);mg.addColorStop(0,'rgba(200,180,220,.03)');mg.addColorStop(1,'rgba(200,180,220,0)');ctx.fillStyle=mg;ctx.beginPath();ctx.arc(_mX,_mY,80,0,Math.PI*2);ctx.fill()}
_rT++;if(_rT>600+Math.random()*900){_rT=0;for(let i=0;i<12;i++)_rP.push({x:W*(.2+Math.random()*.6),y:H*(.2+Math.random()*.4),vx:(Math.random()-.5)*.8,vy:(Math.random()-.5)*.8,r:1+Math.random()*3,l:1,d:.005+Math.random()*.008,h:300+Math.random()*40})}
for(let i=_rP.length-1;i>=0;i--){const rp=_rP[i];rp.x+=rp.vx;rp.y+=rp.vy;rp.vx*=.99;rp.vy*=.99;rp.l-=rp.d;if(rp.l<=0){_rP.splice(i,1);continue}
ctx.beginPath();ctx.arc(rp.x,rp.y,rp.r*rp.l,0,Math.PI*2);ctx.fillStyle='hsla('+rp.h+',70%,60%,'+(rp.l*.4)+')';ctx.fill();
const rg=ctx.createRadialGradient(rp.x,rp.y,0,rp.x,rp.y,rp.r*4);rg.addColorStop(0,'hsla('+rp.h+',60%,55%,'+(rp.l*.1)+')');rg.addColorStop(1,'hsla('+rp.h+',50%,45%,0)');ctx.fillStyle=rg;ctx.beginPath();ctx.arc(rp.x,rp.y,rp.r*4,0,Math.PI*2);ctx.fill()}}

function mainLoop(t){renderBg(t);renderSR(t);renderConf();requestAnimationFrame(mainLoop)}function init(){initBg();initSR();initPaint();initConf();requestAnimationFrame(mainLoop)}window.addEventListener('resize',()=>{initBg();initSR();initConf()});init();
</script></body></html>
