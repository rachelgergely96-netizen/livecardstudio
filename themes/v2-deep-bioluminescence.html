<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>A Living Card For You</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;1,300;1,400&family=Nunito+Sans:wght@300;400&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Nunito Sans',sans-serif;overflow:hidden;width:100vw;height:100vh;touch-action:manipulation;-webkit-font-smoothing:antialiased;background:#04081A}canvas{position:fixed;inset:0;z-index:0}
.envelope-screen{position:fixed;inset:0;z-index:100;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#04081A;cursor:pointer;transition:opacity 1.4s cubic-bezier(.4,0,.2,1),transform 1.4s cubic-bezier(.4,0,.2,1)}.envelope-screen.opened{opacity:0;transform:scale(1.15);pointer-events:none}
.env-wrap{position:relative;width:160px;height:130px}.env-body{width:160px;height:100px;background:linear-gradient(145deg,#0E1530,#081020);border-radius:5px;position:absolute;bottom:0;box-shadow:0 10px 50px rgba(0,0,0,.5);border:1px solid rgba(80,180,220,.06)}.env-flap{width:0;height:0;border-left:80px solid transparent;border-right:80px solid transparent;border-top:65px solid #121A38;position:absolute;top:0;transition:transform 1s cubic-bezier(.4,0,.2,1);transform-origin:top center}.envelope-screen:hover .env-flap{transform:rotateX(50deg)}
.env-seal{width:30px;height:30px;border-radius:50%;background:linear-gradient(135deg,#50B4DC,#3888C0);position:absolute;top:38px;left:50%;transform:translateX(-50%);z-index:2;box-shadow:0 3px 20px rgba(56,136,192,.4);display:flex;align-items:center;justify-content:center;font-size:.65rem;color:#04081A;animation:seal 4s ease-in-out infinite}@keyframes seal{0%,100%{transform:translateX(-50%) scale(1);box-shadow:0 3px 20px rgba(56,136,192,.4)}50%{transform:translateX(-50%) scale(1.1);box-shadow:0 5px 35px rgba(56,136,192,.6)}}
.env-hint{margin-top:2.5rem;font-family:'Cormorant Garamond',serif;font-style:italic;font-size:1.05rem;color:#4A7898;opacity:0;animation:fi 2s ease 1s forwards}.env-from{margin-top:.8rem;font-family:'Cormorant Garamond',serif;font-size:.85rem;letter-spacing:.1em;color:#50B4DC;opacity:0;animation:fi 2s ease 1.5s forwards}@keyframes fi{to{opacity:.7}}
.card-exp{position:fixed;inset:0;z-index:10;display:flex;flex-direction:column;align-items:center;justify-content:center;opacity:0;transition:opacity 1.8s ease .6s;pointer-events:none;padding:2rem}.card-exp.active{opacity:1;pointer-events:auto}
.photo-frame{position:relative;width:min(280px,75vw);height:min(280px,75vw);border-radius:22px;overflow:hidden;cursor:pointer;box-shadow:0 20px 80px rgba(0,0,0,.4),0 0 60px rgba(56,136,192,.04);transition:transform .6s;margin-bottom:2rem;opacity:0;transform:translateY(25px);animation:rev 1.6s ease 1.8s forwards}@keyframes rev{to{opacity:1;transform:translateY(0)}}.photo-frame:hover{transform:scale(1.02)}.photo-canvas{width:100%;height:100%;display:block}
.filter-label{position:absolute;bottom:12px;left:50%;transform:translateX(-50%);font-family:'Cormorant Garamond',serif;font-style:italic;font-size:.8rem;color:#B0D8E8;background:rgba(4,8,26,.55);backdrop-filter:blur(10px);padding:5px 18px;border-radius:20px;pointer-events:none}.tap-hint{position:absolute;top:12px;right:12px;font-size:.6rem;color:#B0D8E8;background:rgba(4,8,26,.45);backdrop-filter:blur(8px);padding:3px 10px;border-radius:12px;opacity:0;animation:fi 1.5s ease 3.5s forwards}
.msg{text-align:center;max-width:420px;opacity:0;transform:translateY(25px);animation:rev 1.6s ease 2.6s forwards}.msg-occ{font-size:.65rem;font-weight:600;letter-spacing:.25em;text-transform:uppercase;color:#50B4DC;margin-bottom:.8rem}.msg-div{display:block;width:45px;height:1px;background:linear-gradient(to right,transparent,#50B4DC,transparent);margin:0 auto 1rem}.msg-txt{font-family:'Cormorant Garamond',serif;font-weight:300;font-size:clamp(1.15rem,3.8vw,1.75rem);line-height:1.65;color:#B0D8E8;margin-bottom:1.5rem}.msg-from{font-family:'Cormorant Garamond',serif;font-style:italic;font-size:1.05rem;color:#3888C0}
.branding{position:fixed;bottom:1.5rem;left:50%;transform:translateX(-50%);z-index:20;font-family:'Cormorant Garamond',serif;font-size:.72rem;color:rgba(56,136,192,.3);opacity:0;letter-spacing:.08em;animation:fi 2s ease 4s forwards}.branding a{color:#50B4DC;text-decoration:none}
@media(max-height:700px){.photo-frame{width:min(200px,55vw);height:min(200px,55vw)}}
</style>
</head>
<body>
<canvas id="c"></canvas>
<div class="envelope-screen" id="env"><div class="env-wrap"><div class="env-flap"></div><div class="env-body"></div><div class="env-seal">◎</div></div><p class="env-hint">tap to open</p><p class="env-from">from the deepest part of me</p></div>
<div class="card-exp" id="exp"><div class="photo-frame" id="pf"><canvas class="photo-canvas" id="pc"></canvas><div class="filter-label" id="fl">Original</div><div class="tap-hint">tap to transform</div></div><div class="msg"><p class="msg-occ">Just Because</p><span class="msg-div"></span><p class="msg-txt">You exist like something discovered in the deep — rare, luminous, and completely impossible to look away from.</p><p class="msg-from">— in awe of you, always</p></div></div>
<div class="branding">made with <a href="#">LiveCardStudio</a> — cards that breathe</div>
<script>
const P=new Uint8Array(512),G=[];(function(){const p=[];for(let i=0;i<256;i++)p[i]=i;for(let i=255;i>0;i--){const j=Math.floor(Math.random()*(i+1));[p[i],p[j]]=[p[j],p[i]];}for(let i=0;i<512;i++)P[i]=p[i&255];for(let i=0;i<256;i++){const a=Math.random()*Math.PI*2;G[i]=[Math.cos(a),Math.sin(a)];}})();
function fade(t){return t*t*t*(t*(t*6-15)+10)}function lerp(a,b,t){return a+(b-a)*t}function dot2(g,x,y){return g[0]*x+g[1]*y}
function noise2D(x,y){const X=Math.floor(x)&255,Y=Math.floor(y)&255,xf=x-Math.floor(x),yf=y-Math.floor(y),u=fade(xf),v=fade(yf);return lerp(lerp(dot2(G[P[P[X]+Y]],xf,yf),dot2(G[P[P[X+1]+Y]],xf-1,yf),u),lerp(dot2(G[P[P[X]+Y+1]],xf,yf-1),dot2(G[P[P[X+1]+Y+1]],xf-1,yf-1),u),v)}
function fbm(x,y,o=4){let v=0,a=.5,f=1;for(let i=0;i<o;i++){v+=a*noise2D(x*f,y*f);a*=.5;f*=2;}return v}

const canvas=document.getElementById('c'),ctx=canvas.getContext('2d');let W,H,t=0,mx=0,my=0,mxS=0,myS=0;
function resize(){W=canvas.width=innerWidth;H=canvas.height=innerHeight}resize();addEventListener('resize',resize);
addEventListener('mousemove',e=>{mx=e.clientX;my=e.clientY});addEventListener('touchmove',e=>{mx=e.touches[0].clientX;my=e.touches[0].clientY},{passive:true});

// ═══ DEEP WATER WASHES ═══
class DeepWash{
  constructor(){this.x=Math.random()*W;this.y=Math.random()*H;this.R=150+Math.random()*350;this.h=[200,210,220,230,240,195][Math.floor(Math.random()*6)];this.s=20+Math.random()*20;this.l=8+Math.random()*10;this.a=.04+Math.random()*.06;this.ph=Math.random()*Math.PI*2;this.sp=.0002+Math.random()*.0003;this.no=Math.random()*100}
  draw(t){const b=Math.sin(t*this.sp+this.ph)*.15+1,r=this.R*b,nx=noise2D(this.no+t*.00005,0)*50,ny=noise2D(0,this.no+t*.00004)*40,x=this.x+nx,y=this.y+ny,hs=noise2D(t*.00008,this.no)*8,g=ctx.createRadialGradient(x,y,0,x,y,r);g.addColorStop(0,`hsla(${this.h+hs},${this.s}%,${this.l}%,${this.a})`);g.addColorStop(.5,`hsla(${this.h+hs},${this.s-3}%,${this.l-1}%,${this.a*.4})`);g.addColorStop(1,`hsla(${this.h},${this.s}%,${this.l}%,0)`);ctx.fillStyle=g;ctx.beginPath();ctx.arc(x,y,r,0,Math.PI*2);ctx.fill()}
}

// ═══ CAUSTIC LIGHT RIPPLES ═══
function drawCaustics(t){
  ctx.save();ctx.globalAlpha=.015;ctx.globalCompositeOperation='screen';
  for(let i=0;i<6;i++){
    const x=W*(.1+Math.random()*.8)+noise2D(i*10+t*.00008,0)*80;
    const y=H*(.05+Math.random()*.3)+noise2D(0,i*10+t*.00006)*40;
    const r=40+Math.random()*80;
    const g=ctx.createRadialGradient(x,y,0,x,y,r);
    const pulse=.5+Math.sin(t*.001+i*2)*.5;
    g.addColorStop(0,`rgba(80,200,240,${.08*pulse})`);
    g.addColorStop(.4,`rgba(60,180,220,${.03*pulse})`);
    g.addColorStop(1,'rgba(60,180,220,0)');
    ctx.fillStyle=g;ctx.beginPath();ctx.arc(x,y,r,0,Math.PI*2);ctx.fill();
  }
  ctx.restore();
}

// ═══ JELLYFISH ═══
class Jellyfish{
  constructor(dp){this.dp=dp;this.sc=[.3,.55,1][dp];this.aBase=[.04,.1,.2][dp];this.reset(true)}
  reset(init){
    this.x=Math.random()*W;this.y=init?Math.random()*H:H+40+Math.random()*80;
    this.sz=(12+Math.random()*15)*this.sc;
    this.vy=-(0.08+Math.random()*.15)*this.sc;
    this.vx=0;
    this.alpha=this.aBase;
    this.hue=[190,210,270,300,180][Math.floor(Math.random()*5)];
    this.sat=30+Math.random()*25;
    this.no=Math.random()*200;
    this.pulsePh=Math.random()*Math.PI*2;
    this.pulseSp=.015+Math.random()*.02;
    this.tentacles=3+Math.floor(Math.random()*4);
  }
  update(t){
    const pulse=Math.sin(t*this.pulseSp+this.pulsePh);
    this.vy+=(pulse>0?-.002:.001)*this.sc; // Swim on contraction
    this.vy=Math.max(this.vy,-.4*this.sc);
    this.vy=Math.min(this.vy,.05);
    const drift=noise2D(this.no+t*.0002,this.y*.003)*.2;
    this.vx=drift*this.sc;
    this.x+=this.vx;this.y+=this.vy;
    if(this.y<-80)this.reset(false);
    if(this.x<-50)this.x=W+50;if(this.x>W+50)this.x=-50;
  }
  draw(t){
    const pulse=Math.sin(t*this.pulseSp+this.pulsePh);
    const bellWidth=this.sz*(1+pulse*.15);
    const bellHeight=this.sz*.7*(1-pulse*.1);
    
    ctx.save();ctx.globalAlpha=this.alpha;
    
    // Outer glow
    const gR=this.sz*3;
    const og=ctx.createRadialGradient(this.x,this.y-bellHeight*.3,0,this.x,this.y,gR);
    og.addColorStop(0,`hsla(${this.hue},${this.sat}%,50%,${.04})`);
    og.addColorStop(1,`hsla(${this.hue},${this.sat}%,50%,0)`);
    ctx.fillStyle=og;ctx.beginPath();ctx.arc(this.x,this.y,gR,0,Math.PI*2);ctx.fill();
    
    // Bell (dome shape)
    ctx.fillStyle=`hsla(${this.hue},${this.sat}%,55%,${.12+pulse*.03})`;
    ctx.beginPath();
    ctx.moveTo(this.x-bellWidth*.5,this.y);
    ctx.quadraticCurveTo(this.x-bellWidth*.55,this.y-bellHeight*.6,this.x,this.y-bellHeight);
    ctx.quadraticCurveTo(this.x+bellWidth*.55,this.y-bellHeight*.6,this.x+bellWidth*.5,this.y);
    ctx.quadraticCurveTo(this.x,this.y+bellHeight*.15,this.x-bellWidth*.5,this.y);
    ctx.fill();
    
    // Inner glow
    const ig=ctx.createRadialGradient(this.x,this.y-bellHeight*.4,0,this.x,this.y-bellHeight*.2,bellWidth*.4);
    ig.addColorStop(0,`hsla(${this.hue-10},${this.sat+10}%,70%,${.15+pulse*.05})`);
    ig.addColorStop(1,`hsla(${this.hue},${this.sat}%,55%,0)`);
    ctx.fillStyle=ig;ctx.beginPath();ctx.arc(this.x,this.y-bellHeight*.4,bellWidth*.4,0,Math.PI*2);ctx.fill();
    
    // Tentacles
    ctx.strokeStyle=`hsla(${this.hue},${this.sat-5}%,50%,${.08+pulse*.02})`;
    ctx.lineWidth=.5*this.sc;
    for(let i=0;i<this.tentacles;i++){
      const tx=this.x+((i/(this.tentacles-1))-.5)*bellWidth*.6;
      const wave1=noise2D(this.no+i+t*.0005,t*.0003)*15*this.sc;
      const wave2=noise2D(this.no+i*3+t*.0003,t*.0004)*10*this.sc;
      const len=this.sz*(.8+Math.random()*.6);
      ctx.beginPath();ctx.moveTo(tx,this.y+bellHeight*.05);
      ctx.bezierCurveTo(tx+wave1*.3,this.y+len*.3,tx+wave1,this.y+len*.6+wave2*.3,tx+wave1*.5+wave2,this.y+len);
      ctx.stroke();
      // Bioluminescent dots on tentacles
      if(this.dp===2&&Math.random()<.3){
        const dotY=this.y+len*(.3+Math.random()*.5);
        const dotX=tx+wave1*(.2+Math.random()*.5);
        ctx.fillStyle=`hsla(${this.hue},${this.sat+10}%,70%,${.1+Math.random()*.1})`;
        ctx.beginPath();ctx.arc(dotX,dotY,.5+Math.random()*.5,0,Math.PI*2);ctx.fill();
      }
    }
    
    ctx.restore();
  }
}

// ═══ BIOLUMINESCENT PLANKTON ═══
class Plankton{
  constructor(){this.x=Math.random()*W;this.y=Math.random()*H;this.sz=.4+Math.random()*1;this.a=.05+Math.random()*.1;this.no=Math.random()*200;this.sp=.015+Math.random()*.03;this.an=Math.random()*Math.PI*2;this.hue=180+Math.random()*60;this.blinkPh=Math.random()*Math.PI*2;this.blinkSp=.005+Math.random()*.015}
  update(t){
    const n=noise2D(this.no+t*.0002,this.y*.005);
    this.x+=Math.cos(this.an+n*3)*this.sp;
    this.y+=Math.sin(this.an+n*2)*this.sp-.005;
    // Mouse causes bioluminescent reaction
    const dx=mxS-this.x,dy=myS-this.y,d=Math.sqrt(dx*dx+dy*dy);
    if(d<150){this.x-=dx*.002;this.y-=dy*.002;this.a=Math.min(.25,this.a+.003);}
    else{this.a=Math.max(.05,this.a-.001);}
    if(this.x<-10)this.x=W+10;if(this.x>W+10)this.x=-10;
    if(this.y<-10)this.y=H+10;if(this.y>H+10)this.y=-10;
  }
  draw(t){
    const blink=Math.max(0,Math.sin(t*this.blinkSp+this.blinkPh));
    const a=this.a*(.3+blink*.7);
    if(a<.01)return;
    ctx.save();ctx.globalAlpha=a;
    // Glow
    if(this.sz>.7){
      const g=ctx.createRadialGradient(this.x,this.y,0,this.x,this.y,this.sz*6);
      g.addColorStop(0,`hsla(${this.hue},50%,60%,.1)`);
      g.addColorStop(1,`hsla(${this.hue},50%,60%,0)`);
      ctx.fillStyle=g;ctx.beginPath();ctx.arc(this.x,this.y,this.sz*6,0,Math.PI*2);ctx.fill();
    }
    ctx.fillStyle=`hsla(${this.hue},45%,70%,.8)`;
    ctx.beginPath();ctx.arc(this.x,this.y,this.sz,0,Math.PI*2);ctx.fill();
    ctx.restore();
  }
}

// ═══ BUBBLES ═══
class Bubble{
  constructor(){this.reset(true)}
  reset(init){this.x=Math.random()*W;this.y=init?Math.random()*H:H+10+Math.random()*30;this.sz=1+Math.random()*3;this.vy=-(0.2+Math.random()*.4);this.no=Math.random()*200;this.alpha=.03+Math.random()*.06}
  update(t){this.y+=this.vy;this.x+=noise2D(this.no+t*.0003,this.y*.005)*.3;if(this.y<-10)this.reset(false);}
  draw(t){ctx.save();ctx.globalAlpha=this.alpha;ctx.strokeStyle='rgba(100,200,230,.3)';ctx.lineWidth=.3;ctx.beginPath();ctx.arc(this.x,this.y,this.sz,0,Math.PI*2);ctx.stroke();
  // Highlight
  ctx.fillStyle=`rgba(160,230,250,${this.alpha*.5})`;ctx.beginPath();ctx.arc(this.x-this.sz*.25,this.y-this.sz*.25,this.sz*.25,0,Math.PI*2);ctx.fill();ctx.restore();}
}

// ═══ KELP SILHOUETTES ═══
function drawKelp(t){
  ctx.save();ctx.globalAlpha=.06;
  const bases=[W*.08,W*.2,W*.35,W*.6,W*.78,W*.92];
  bases.forEach((bx,i)=>{
    const height=H*.3+noise2D(i*5,0)*H*.15;
    const segments=12;
    ctx.strokeStyle=`hsl(${160+i*10},20%,15%)`;ctx.lineWidth=2+Math.random();
    ctx.beginPath();ctx.moveTo(bx,H);
    let cx=bx,cy=H;
    for(let s=0;s<segments;s++){
      const p=s/segments;
      const sway=noise2D(i*3+s*.5+t*.0003,t*.0002)*(15+p*20);
      cy=H-height*p;cx=bx+sway;
      ctx.lineTo(cx,cy);
    }
    ctx.stroke();
    // Leaves
    for(let s=3;s<segments;s+=2){
      const p=s/segments;
      const lx=bx+noise2D(i*3+s*.5+t*.0003,t*.0002)*(15+p*20);
      const ly=H-height*p;
      const leafLen=10+Math.random()*15;
      const leafDir=i%2===0?1:-1;
      ctx.beginPath();ctx.moveTo(lx,ly);
      ctx.quadraticCurveTo(lx+leafLen*leafDir*.5,ly-5,lx+leafLen*leafDir,ly+3);
      ctx.stroke();
    }
  });
  ctx.restore();
}

// ═══ INIT ═══
const washes=Array.from({length:7},()=>new DeepWash);
const jellyFar=Array.from({length:6},()=>new Jellyfish(0));
const jellyMid=Array.from({length:4},()=>new Jellyfish(1));
const jellyNear=Array.from({length:2},()=>new Jellyfish(2));
const plankton=Array.from({length:70},()=>new Plankton);
const bubbles=Array.from({length:15},()=>new Bubble);
const touchPlankton=[];

// ═══ RENDER ═══
function render(){
  t++;mxS+=(mx-mxS)*.03;myS+=(my-myS)*.03;
  
  const bg=ctx.createLinearGradient(0,0,0,H);
  bg.addColorStop(0,'#06101E');bg.addColorStop(.3,'#04081A');bg.addColorStop(.7,'#030618');bg.addColorStop(1,'#020410');
  ctx.fillStyle=bg;ctx.fillRect(0,0,W,H);
  
  washes.forEach(w=>w.draw(t));
  drawCaustics(t);
  drawKelp(t);
  jellyFar.forEach(j=>{j.update(t);j.draw(t)});
  plankton.forEach(p=>{p.update(t);p.draw(t)});
  bubbles.forEach(b=>{b.update(t);b.draw(t)});
  jellyMid.forEach(j=>{j.update(t);j.draw(t)});
  jellyNear.forEach(j=>{j.update(t);j.draw(t)});
  touchPlankton.forEach(p=>{p.update(t);p.draw(t)});
  for(let i=touchPlankton.length-1;i>=0;i--){touchPlankton[i].a-=.0003;if(touchPlankton[i].a<=0)touchPlankton.splice(i,1);}
  
  if(t%5===0)for(let i=0;i<20;i++){ctx.fillStyle=`rgba(60,140,180,${Math.random()*.003})`;ctx.fillRect(Math.random()*W,Math.random()*H,1,1);}
  
  requestAnimationFrame(render);
}
render();

document.getElementById('env').addEventListener('click',()=>{document.getElementById('env').classList.add('opened');setTimeout(()=>{document.getElementById('exp').classList.add('active');document.getElementById('env').style.display='none'},700)});

const pc=document.getElementById('pc'),pctx=pc.getContext('2d'),fl=document.getElementById('fl');
const FILTERS=['Original','Deep Blue','Bioluminescent','Sea Glass','Abyssal'];let cf=0,oD;
function genP(w,h){const o=document.createElement('canvas');o.width=w;o.height=h;const c=o.getContext('2d');const bg=c.createLinearGradient(0,0,w,h);bg.addColorStop(0,'#1A2848');bg.addColorStop(.4,'#122040');bg.addColorStop(.7,'#182845');bg.addColorStop(1,'#0E1835');c.fillStyle=bg;c.fillRect(0,0,w,h);for(let i=0;i<10;i++){const x=w*.15+Math.random()*w*.7,y=h*.15+Math.random()*h*.7,r=20+Math.random()*50,g=c.createRadialGradient(x,y,0,x,y,r);g.addColorStop(0,`hsla(${200+Math.random()*40},35%,45%,.3)`);g.addColorStop(1,'transparent');c.fillStyle=g;c.beginPath();c.arc(x,y,r,0,Math.PI*2);c.fill()}for(let i=0;i<2e3;i++){c.fillStyle=`rgba(100,200,230,${Math.random()*.04})`;c.fillRect(Math.random()*w,Math.random()*h,1,1)}c.font='300 15px "Cormorant Garamond",serif';c.textAlign='center';c.fillStyle='rgba(100,200,230,.3)';c.fillText('your photo here',w/2,h*.83);c.font='300 10px "Nunito Sans",sans-serif';c.fillText('(tap to see art filters)',w/2,h*.89);return o}
function initP(){const f=document.getElementById('pf'),s=f.offsetWidth||280;pc.width=s;pc.height=s;pctx.drawImage(genP(s,s),0,0);oD=pctx.getImageData(0,0,s,s)}
function apF(n){const w=pc.width,h=pc.height;pctx.putImageData(oD,0,0);if(n==='Original')return;const id=pctx.getImageData(0,0,w,h),d=id.data;
if(n==='Deep Blue'){for(let i=0;i<d.length;i+=4){d[i]=Math.min(255,d[i]*.7+5);d[i+1]=Math.min(255,d[i+1]*.85+15);d[i+2]=Math.min(255,d[i+2]*1.2+25)}pctx.putImageData(id,0,0);const v=pctx.createRadialGradient(w/2,h/2,w*.15,w/2,h/2,w*.6);v.addColorStop(0,'rgba(60,160,200,.05)');v.addColorStop(1,'rgba(4,8,26,.2)');pctx.fillStyle=v;pctx.fillRect(0,0,w,h)}
else if(n==='Bioluminescent'){for(let i=0;i<d.length;i+=4){d[i]=Math.min(255,d[i]*.8+5);d[i+1]=Math.min(255,d[i+1]*1.05+10);d[i+2]=Math.min(255,d[i+2]*1.15+15)}pctx.putImageData(id,0,0);for(let i=0;i<30;i++){const x=Math.random()*w,y=Math.random()*h,r=1+Math.random()*2,g=pctx.createRadialGradient(x,y,0,x,y,r*4);const hue=180+Math.random()*60;g.addColorStop(0,`hsla(${hue},50%,60%,${.08+Math.random()*.08})`);g.addColorStop(1,`hsla(${hue},50%,60%,0)`);pctx.fillStyle=g;pctx.beginPath();pctx.arc(x,y,r*4,0,Math.PI*2);pctx.fill()}}
else if(n==='Sea Glass'){for(let i=0;i<d.length;i+=4){const avg=(d[i]+d[i+1]+d[i+2])/3;d[i]=Math.min(255,avg*.75+20);d[i+1]=Math.min(255,avg*.9+30);d[i+2]=Math.min(255,avg*1+25)}pctx.putImageData(id,0,0);pctx.globalAlpha=.2;for(let i=0;i<5;i++)pctx.drawImage(pc,(Math.random()-.5)*5,(Math.random()-.5)*5);pctx.globalAlpha=1;pctx.fillStyle='rgba(4,8,26,.08)';pctx.fillRect(0,0,w,h)}
else if(n==='Abyssal'){for(let i=0;i<d.length;i+=4){d[i]=Math.min(255,d[i]*.55+3);d[i+1]=Math.min(255,d[i+1]*.6+8);d[i+2]=Math.min(255,d[i+2]*.75+12);for(let c2=0;c2<3;c2++)d[i+c2]=Math.min(255,Math.max(0,(d[i+c2]-128)*1.4+128))}pctx.putImageData(id,0,0);for(let i=0;i<8;i++){const x=Math.random()*w,y=Math.random()*h,r=1+Math.random();pctx.fillStyle=`rgba(80,200,240,${.12+Math.random()*.15})`;pctx.beginPath();pctx.arc(x,y,r,0,Math.PI*2);pctx.fill();}pctx.fillStyle='rgba(4,8,26,.15)';pctx.fillRect(0,0,w,h)}}
document.getElementById('pf').addEventListener('click',e=>{cf=(cf+1)%FILTERS.length;pc.style.transition='opacity .3s';pc.style.opacity='.4';setTimeout(()=>{apF(FILTERS[cf]);fl.textContent=FILTERS[cf];pc.style.opacity='1'},250);spB(e.clientX,e.clientY)});
function spB(x,y){for(let i=0;i<12;i++){const p=new Plankton;p.x=x+(Math.random()-.5)*100;p.y=y+(Math.random()-.5)*80;p.a=.12+Math.random()*.15;p.sz=.5+Math.random()*1.5;p.hue=180+Math.random()*80;touchPlankton.push(p)}}
document.addEventListener('click',e=>{if(e.target.closest('.envelope-screen')||e.target.closest('.photo-frame'))return;spB(e.clientX,e.clientY)});
document.fonts.ready.then(()=>setTimeout(initP,100));addEventListener('resize',()=>{resize();setTimeout(initP,100)});
</script>
</body>
</html>
