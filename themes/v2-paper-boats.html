<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Living Card For You</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;1,300;1,400&family=Nunito+Sans:wght@300;400&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Nunito Sans',sans-serif;overflow:hidden;width:100vw;height:100vh;touch-action:manipulation;-webkit-font-smoothing:antialiased;background:#0C101E}canvas{position:fixed;inset:0;z-index:0}
.envelope-screen{position:fixed;inset:0;z-index:100;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#0C101E;cursor:pointer;transition:opacity 1.4s cubic-bezier(.4,0,.2,1),transform 1.4s cubic-bezier(.4,0,.2,1)}.envelope-screen.opened{opacity:0;transform:scale(1.15);pointer-events:none}
.env-wrap{position:relative;width:160px;height:130px}.env-body{width:160px;height:100px;background:linear-gradient(145deg,#1A1E30,#141828);border-radius:5px;position:absolute;bottom:0;box-shadow:0 10px 50px rgba(0,0,0,.4);border:1px solid rgba(200,185,220,.06)}.env-flap{width:0;height:0;border-left:80px solid transparent;border-right:80px solid transparent;border-top:65px solid #222840;position:absolute;top:0;transition:transform 1s cubic-bezier(.4,0,.2,1);transform-origin:top center}.envelope-screen:hover .env-flap{transform:rotateX(50deg)}
.env-seal{width:30px;height:30px;border-radius:50%;background:linear-gradient(135deg,#D8C8E8,#B0A0C8);position:absolute;top:38px;left:50%;transform:translateX(-50%);z-index:2;box-shadow:0 3px 20px rgba(176,160,200,.4);display:flex;align-items:center;justify-content:center;font-size:.65rem;color:#0C101E;animation:seal 4s ease-in-out infinite}@keyframes seal{0%,100%{transform:translateX(-50%) scale(1)}50%{transform:translateX(-50%) scale(1.1)}}
.env-hint{margin-top:2.5rem;font-family:'Cormorant Garamond',serif;font-style:italic;font-size:1.05rem;color:#7A7A98;opacity:0;animation:fi 2s ease 1s forwards}.env-from{margin-top:.8rem;font-family:'Cormorant Garamond',serif;font-size:.85rem;letter-spacing:.1em;color:#C0B0D8;opacity:0;animation:fi 2s ease 1.5s forwards}@keyframes fi{to{opacity:.7}}
.card-exp{position:fixed;inset:0;z-index:10;display:flex;flex-direction:column;align-items:center;justify-content:center;opacity:0;transition:opacity 1.8s ease .6s;pointer-events:none;padding:2rem}.card-exp.active{opacity:1;pointer-events:auto}
.photo-frame{position:relative;width:min(280px,75vw);height:min(280px,75vw);border-radius:22px;overflow:hidden;cursor:pointer;box-shadow:0 20px 80px rgba(0,0,0,.3),0 0 40px rgba(200,185,220,.04);transition:transform .6s;margin-bottom:2rem;opacity:0;transform:translateY(25px);animation:rev 1.6s ease 1.8s forwards}@keyframes rev{to{opacity:1;transform:translateY(0)}}.photo-frame:hover{transform:scale(1.02)}.photo-canvas{width:100%;height:100%;display:block}
.filter-label{position:absolute;bottom:12px;left:50%;transform:translateX(-50%);font-family:'Cormorant Garamond',serif;font-style:italic;font-size:.8rem;color:#D8D0E8;background:rgba(12,16,30,.55);backdrop-filter:blur(10px);padding:5px 18px;border-radius:20px;pointer-events:none}.tap-hint{position:absolute;top:12px;right:12px;font-size:.6rem;color:#D8D0E8;background:rgba(12,16,30,.45);backdrop-filter:blur(8px);padding:3px 10px;border-radius:12px;opacity:0;animation:fi 1.5s ease 3.5s forwards}
.msg{text-align:center;max-width:420px;opacity:0;transform:translateY(25px);animation:rev 1.6s ease 2.6s forwards}.msg-occ{font-size:.65rem;font-weight:600;letter-spacing:.25em;text-transform:uppercase;color:#C0B0D8;margin-bottom:.8rem}.msg-div{display:block;width:45px;height:1px;background:linear-gradient(to right,transparent,#C0B0D8,transparent);margin:0 auto 1rem}.msg-txt{font-family:'Cormorant Garamond',serif;font-weight:300;font-size:clamp(1.15rem,3.8vw,1.75rem);line-height:1.65;color:#D8D0E8;margin-bottom:1.5rem}.msg-from{font-family:'Cormorant Garamond',serif;font-style:italic;font-size:1.05rem;color:#B0A0C8}
.branding{position:fixed;bottom:1.5rem;left:50%;transform:translateX(-50%);z-index:20;font-family:'Cormorant Garamond',serif;font-size:.72rem;color:rgba(176,160,200,.3);opacity:0;letter-spacing:.08em;animation:fi 2s ease 4s forwards}.branding a{color:#C0B0D8;text-decoration:none}
@media(max-height:700px){.photo-frame{width:min(200px,55vw);height:min(200px,55vw)}}
</style>
</head>
<body>
<canvas id="c"></canvas>
<div class="envelope-screen" id="env"><div class="env-wrap"><div class="env-flap"></div><div class="env-body"></div><div class="env-seal">⛵</div></div><p class="env-hint">tap to open</p><p class="env-from">I sent my heart downriver to find you</p></div>
<div class="card-exp" id="exp"><div class="photo-frame" id="pf"><canvas class="photo-canvas" id="pc"></canvas><div class="filter-label" id="fl">Original</div><div class="tap-hint">tap to transform</div></div><div class="msg"><p class="msg-occ">I Love You</p><span class="msg-div"></span><p class="msg-txt">If I folded every feeling into a paper boat and set it on the water — the river would overflow. That's how much.</p><p class="msg-from">— yours, carried by the current</p></div></div>
<div class="branding">made with <a href="#">LiveCardStudio</a> — cards that breathe</div>
<script>
const P=new Uint8Array(512),G=[];(function(){const p=[];for(let i=0;i<256;i++)p[i]=i;for(let i=255;i>0;i--){const j=Math.floor(Math.random()*(i+1));[p[i],p[j]]=[p[j],p[i]];}for(let i=0;i<512;i++)P[i]=p[i&255];for(let i=0;i<256;i++){const a=Math.random()*Math.PI*2;G[i]=[Math.cos(a),Math.sin(a)];}})();
function fade(t){return t*t*t*(t*(t*6-15)+10)}function lerp(a,b,t){return a+(b-a)*t}function dot2(g,x,y){return g[0]*x+g[1]*y}
function noise2D(x,y){const X=Math.floor(x)&255,Y=Math.floor(y)&255,xf=x-Math.floor(x),yf=y-Math.floor(y),u=fade(xf),v=fade(yf);return lerp(lerp(dot2(G[P[P[X]+Y]],xf,yf),dot2(G[P[P[X+1]+Y]],xf-1,yf),u),lerp(dot2(G[P[P[X]+Y+1]],xf,yf-1),dot2(G[P[P[X+1]+Y+1]],xf-1,yf-1),u),v)}
function fbm(x,y,o=4){let v=0,a=.5,f=1;for(let i=0;i<o;i++){v+=a*noise2D(x*f,y*f);a*=.5;f*=2;}return v}

const canvas=document.getElementById('c'),ctx=canvas.getContext('2d');let W,H,t=0,mx=0,my=0,mxS=0,myS=0;
function resize(){W=canvas.width=innerWidth;H=canvas.height=innerHeight}resize();addEventListener('resize',resize);
addEventListener('mousemove',e=>{mx=e.clientX;my=e.clientY});addEventListener('touchmove',e=>{mx=e.touches[0].clientX;my=e.touches[0].clientY},{passive:true});

const waterY=H*.48; // Water line

// ═══ SKY ═══
function drawSky(t){
  const g=ctx.createLinearGradient(0,0,0,waterY);
  g.addColorStop(0,'#080C18');g.addColorStop(.35,'#0E1428');g.addColorStop(.65,'#141A30');g.addColorStop(.9,'#1A2038');g.addColorStop(1,'#1E2440');
  ctx.fillStyle=g;ctx.fillRect(0,0,W,waterY);
}

// ═══ MOON ═══
function drawMoon(t){
  const mx2=W*.65+noise2D(t*.00003,0)*10,my2=H*.15+noise2D(0,t*.00003)*8;
  const breathe=Math.sin(t*.0002)*.08+1;
  // Haze
  for(let i=3;i>0;i--){const r=35*i*breathe,a=.015/i;const g=ctx.createRadialGradient(mx2,my2,0,mx2,my2,r);g.addColorStop(0,`rgba(200,195,220,${a})`);g.addColorStop(1,'rgba(200,195,220,0)');ctx.fillStyle=g;ctx.beginPath();ctx.arc(mx2,my2,r,0,Math.PI*2);ctx.fill();}
  // Moon body
  ctx.fillStyle='rgba(220,215,235,.12)';ctx.beginPath();ctx.arc(mx2,my2,14*breathe,0,Math.PI*2);ctx.fill();
  ctx.fillStyle='rgba(240,235,250,.06)';ctx.beginPath();ctx.arc(mx2,my2,8*breathe,0,Math.PI*2);ctx.fill();
  
  // Moon reflection column on water
  const colW=25+Math.sin(t*.0005)*8;
  for(let y=waterY;y<H;y+=2){
    const shimmer=noise2D(y*.015+t*.001,t*.0003)*colW;
    const fade2=(y-waterY)/(H-waterY);
    ctx.fillStyle=`rgba(200,195,230,${.015*(1-fade2*.7)})`;
    ctx.fillRect(mx2-colW/2+shimmer,y,colW-Math.abs(shimmer),2);
  }
}

// ═══ STARS ═══
class Star{constructor(){this.x=Math.random()*W;this.y=Math.random()*waterY;this.sz=.3+Math.random()*1;this.al=.08+Math.random()*.2;this.twSp=.002+Math.random()*.006;this.ph=Math.random()*Math.PI*2}draw(t){const tw=.3+Math.sin(t*this.twSp+this.ph)*.7;ctx.globalAlpha=this.al*tw;ctx.fillStyle='rgba(220,215,240,.9)';ctx.beginPath();ctx.arc(this.x,this.y,this.sz,0,Math.PI*2);ctx.fill();ctx.globalAlpha=1}}

// ═══ WATER ═══
function drawWater(t){
  // Base water
  const g=ctx.createLinearGradient(0,waterY,0,H);
  g.addColorStop(0,'#0E1428');g.addColorStop(.2,'#0A1020');g.addColorStop(.5,'#080C1A');g.addColorStop(1,'#060A15');
  ctx.fillStyle=g;ctx.fillRect(0,waterY,W,H-waterY);
  
  // Ripple lines
  ctx.save();ctx.globalAlpha=.03;
  for(let y=waterY+5;y<H;y+=6+Math.random()*8){
    const offset=noise2D(y*.01+t*.0004,t*.0002)*30;
    const len=80+noise2D(y*.005,0)*120;
    const cx=W*.5+offset;
    ctx.strokeStyle=`rgba(180,185,220,${.2+noise2D(y*.02,t*.001)*.2})`;
    ctx.lineWidth=.4;
    ctx.beginPath();ctx.moveTo(cx-len/2,y);
    ctx.bezierCurveTo(cx-len/4,y+noise2D(y*.03,t*.001)*2,cx+len/4,y-noise2D(y*.03+1,t*.001)*2,cx+len/2,y);
    ctx.stroke();
  }
  ctx.restore();
}

// ═══ PAPER BOATS ═══
class PaperBoat{
  constructor(dp){this.dp=dp;this.sc=[.4,.65,1][dp];this.aBase=[.08,.18,.35][dp];this.reset(true)}
  reset(init){
    this.x=init?Math.random()*W:-30-Math.random()*60;
    this.y=waterY+15+Math.random()*(H-waterY-60)*.5*(1+this.dp*.3);
    this.sz=(10+Math.random()*8)*this.sc;
    this.vx=(.15+Math.random()*.25)*this.sc;
    this.vy=0;
    this.alpha=this.aBase;
    this.no=Math.random()*200;
    this.bobPh=Math.random()*Math.PI*2;
    this.bobSp=.012+Math.random()*.015;
    this.tiltPh=Math.random()*Math.PI*2;
    this.hue=35+Math.random()*15;
    this.flickerPh=Math.random()*Math.PI*2;
    this.flickerSp=.02+Math.random()*.03;
    this.paperHue=Math.random()>.6?0:20+Math.random()*30; // some white, some warm
    this.paperSat=this.paperHue===0?0:8+Math.random()*12;
    this.paperLight=85+Math.random()*10;
  }
  update(t){
    const drift=noise2D(this.no+t*.0001,this.y*.005)*.2;
    this.vx+=drift*.01;this.vx=Math.max(.05*this.sc,Math.min(this.vx,.4*this.sc));
    this.x+=this.vx;
    this.vy=Math.sin(t*this.bobSp+this.bobPh)*.15*this.sc;
    this.y+=this.vy;
    if(this.x>W+50)this.reset(false);
  }
  draw(t){
    const bob=Math.sin(t*this.bobSp+this.bobPh)*2*this.sc;
    const tilt=Math.sin(t*this.bobSp*.7+this.tiltPh)*.08;
    const flicker=.7+Math.sin(t*this.flickerSp+this.flickerPh)*.3;
    const y=this.y+bob;
    
    ctx.save();ctx.translate(this.x,y);ctx.rotate(tilt);ctx.globalAlpha=this.alpha;
    
    // Candle glow on water (reflection)
    const gR=this.sz*4*flicker;
    const rg=ctx.createRadialGradient(0,this.sz*.3,0,0,this.sz*2,gR);
    rg.addColorStop(0,`hsla(${this.hue},50%,55%,${.04*flicker})`);
    rg.addColorStop(1,`hsla(${this.hue},45%,50%,0)`);
    ctx.fillStyle=rg;ctx.beginPath();ctx.ellipse(0,this.sz*2,gR,gR*.3,0,0,Math.PI*2);ctx.fill();
    
    // Candle glow above
    const ag=ctx.createRadialGradient(0,-this.sz*.5,0,0,-this.sz*.3,this.sz*3*flicker);
    ag.addColorStop(0,`hsla(${this.hue},50%,60%,${.06*flicker})`);
    ag.addColorStop(.4,`hsla(${this.hue},45%,55%,${.02*flicker})`);
    ag.addColorStop(1,`hsla(${this.hue},40%,50%,0)`);
    ctx.fillStyle=ag;ctx.beginPath();ctx.arc(0,-this.sz*.3,this.sz*3*flicker,0,Math.PI*2);ctx.fill();
    
    // Boat hull (origami shape)
    const bw=this.sz,bh=this.sz*.5;
    ctx.fillStyle=`hsla(${this.paperHue},${this.paperSat}%,${this.paperLight}%,${.15+flicker*.05})`;
    ctx.beginPath();
    ctx.moveTo(-bw,0); // left point
    ctx.lineTo(0,-bh*.4); // bottom center V
    ctx.lineTo(bw,0); // right point
    ctx.lineTo(0,bh*.3); // bottom
    ctx.closePath();ctx.fill();
    
    // Sail (triangle)
    ctx.fillStyle=`hsla(${this.paperHue},${this.paperSat}%,${this.paperLight+3}%,${.12+flicker*.04})`;
    ctx.beginPath();
    ctx.moveTo(0,-bh*.3);
    ctx.lineTo(-bw*.3,-bh*1.8);
    ctx.lineTo(bw*.15,-bh*.3);
    ctx.closePath();ctx.fill();
    
    // Fold line
    ctx.strokeStyle=`hsla(${this.paperHue},${this.paperSat}%,${this.paperLight-15}%,${.05})`;
    ctx.lineWidth=.3*this.sc;
    ctx.beginPath();ctx.moveTo(-bw*.5,0);ctx.lineTo(bw*.5,0);ctx.stroke();
    
    // Candle flame
    const fh=this.sz*.6*flicker;
    const fg=ctx.createRadialGradient(0,-bh*.8,0,0,-bh*.8-fh*.3,fh);
    fg.addColorStop(0,`rgba(255,240,180,${.25*flicker})`);
    fg.addColorStop(.3,`rgba(255,200,100,${.12*flicker})`);
    fg.addColorStop(1,'rgba(255,200,100,0)');
    ctx.fillStyle=fg;ctx.beginPath();ctx.arc(0,-bh*.8-fh*.3,fh,0,Math.PI*2);ctx.fill();
    
    // Flame core
    ctx.fillStyle=`rgba(255,245,220,${.3*flicker})`;
    ctx.beginPath();ctx.arc(0,-bh*1,fh*.15,0,Math.PI*2);ctx.fill();
    
    ctx.restore();
  }
}

// ═══ WATER PETALS ═══
class WaterPetal{
  constructor(){this.x=Math.random()*W;this.y=waterY+10+Math.random()*(H-waterY-30)*.4;this.sz=1.5+Math.random()*2.5;this.vx=.05+Math.random()*.1;this.alpha=.04+Math.random()*.06;this.rot=Math.random()*Math.PI*2;this.no=Math.random()*100;this.hue=340+Math.random()*20}
  update(t){this.x+=this.vx+noise2D(this.no+t*.0002,0)*.05;this.y+=Math.sin(t*.01+this.no)*.1;if(this.x>W+10)this.x=-10;}
  draw(t){ctx.save();ctx.translate(this.x,this.y);ctx.rotate(this.rot+noise2D(this.no,t*.0002)*.1);ctx.globalAlpha=this.alpha;ctx.fillStyle=`hsl(${this.hue},28%,80%)`;ctx.beginPath();ctx.moveTo(0,-this.sz*.4);ctx.bezierCurveTo(this.sz*.35,-this.sz*.3,this.sz*.35,this.sz*.1,0,this.sz*.4);ctx.bezierCurveTo(-this.sz*.35,this.sz*.1,-this.sz*.35,-this.sz*.3,0,-this.sz*.4);ctx.fill();ctx.restore();}
}

// ═══ FIREFLIES ABOVE WATER ═══
class WaterFirefly{
  constructor(){this.x=Math.random()*W;this.y=waterY-20-Math.random()*80;this.tx=this.x;this.ty=this.y;this.sz=1+Math.random()*1.5;this.sp=.15+Math.random()*.25;this.no=Math.random()*200;this.blinkPh=Math.random()*Math.PI*2;this.blinkSp=.012+Math.random()*.02;this.hue=50+Math.random()*20}
  update(t){const dx=this.tx-this.x,dy=this.ty-this.y,d=Math.sqrt(dx*dx+dy*dy);if(d<10){this.tx=Math.max(20,Math.min(W-20,this.x+(Math.random()-.5)*120));this.ty=Math.max(waterY-120,Math.min(waterY-10,this.y+(Math.random()-.5)*60));}this.x+=dx/(d||1)*this.sp+noise2D(this.no+t*.0003,0)*.2;this.y+=dy/(d||1)*this.sp+noise2D(0,this.no+t*.0002)*.15;}
  draw(t){const blink=Math.max(0,Math.sin(t*this.blinkSp+this.blinkPh));if(blink<.05)return;ctx.save();ctx.globalAlpha=blink*.3;const g=ctx.createRadialGradient(this.x,this.y,0,this.x,this.y,this.sz*8);g.addColorStop(0,`hsla(${this.hue},55%,65%,.15)`);g.addColorStop(1,`hsla(${this.hue},50%,60%,0)`);ctx.fillStyle=g;ctx.beginPath();ctx.arc(this.x,this.y,this.sz*8,0,Math.PI*2);ctx.fill();ctx.fillStyle=`hsla(${this.hue},60%,80%,${blink*.5})`;ctx.beginPath();ctx.arc(this.x,this.y,this.sz*.5,0,Math.PI*2);ctx.fill();
  // Reflection on water
  const ry=waterY+(waterY-this.y)*.15+waterY*.02;
  ctx.globalAlpha=blink*.06;const rg=ctx.createRadialGradient(this.x,ry,0,this.x,ry,this.sz*4);rg.addColorStop(0,`hsla(${this.hue},50%,60%,.1)`);rg.addColorStop(1,`hsla(${this.hue},50%,60%,0)`);ctx.fillStyle=rg;ctx.beginPath();ctx.ellipse(this.x,ry,this.sz*4,this.sz*1.5,0,0,Math.PI*2);ctx.fill();
  ctx.restore();}
}

// ═══ INIT ═══
const stars=Array.from({length:45},()=>new Star);
const boatsFar=Array.from({length:6},()=>new PaperBoat(0));
const boatsMid=Array.from({length:4},()=>new PaperBoat(1));
const boatsNear=Array.from({length:3},()=>new PaperBoat(2));
const petals=Array.from({length:12},()=>new WaterPetal);
const fireflies=Array.from({length:10},()=>new WaterFirefly);
const touchBoats=[];

// ═══ RENDER ═══
function render(){
  t++;mxS+=(mx-mxS)*.03;myS+=(my-myS)*.03;
  
  drawSky(t);
  stars.forEach(s=>s.draw(t));
  drawMoon(t);
  fireflies.forEach(f=>{f.update(t);f.draw(t)});
  drawWater(t);
  boatsFar.forEach(b=>{b.update(t);b.draw(t)});
  petals.forEach(p=>{p.update(t);p.draw(t)});
  boatsMid.forEach(b=>{b.update(t);b.draw(t)});
  boatsNear.forEach(b=>{b.update(t);b.draw(t)});
  touchBoats.forEach(b=>{b.update(t);b.draw(t)});
  for(let i=touchBoats.length-1;i>=0;i--){if(touchBoats[i].x>W+50)touchBoats.splice(i,1);}
  
  if(t%5===0)for(let i=0;i<20;i++){ctx.fillStyle=`rgba(160,165,200,${Math.random()*.003})`;ctx.fillRect(Math.random()*W,Math.random()*H,1,1);}
  
  requestAnimationFrame(render);
}
render();

document.getElementById('env').addEventListener('click',()=>{document.getElementById('env').classList.add('opened');setTimeout(()=>{document.getElementById('exp').classList.add('active');document.getElementById('env').style.display='none'},700)});

const pc=document.getElementById('pc'),pctx=pc.getContext('2d'),fl=document.getElementById('fl');
const FILTERS=['Original','Moonlit River','Paper Texture','Candlelight','Midnight Silk'];let cf=0,oD;
function genP(w,h){const o=document.createElement('canvas');o.width=w;o.height=h;const c=o.getContext('2d');const bg=c.createLinearGradient(0,0,w,h);bg.addColorStop(0,'#2A2840');bg.addColorStop(.4,'#222038');bg.addColorStop(.7,'#2A2540');bg.addColorStop(1,'#1E1A30');c.fillStyle=bg;c.fillRect(0,0,w,h);for(let i=0;i<10;i++){const x=w*.15+Math.random()*w*.7,y=h*.15+Math.random()*h*.7,r=20+Math.random()*50,g=c.createRadialGradient(x,y,0,x,y,r);g.addColorStop(0,`hsla(${250+Math.random()*30},25%,45%,.3)`);g.addColorStop(1,'transparent');c.fillStyle=g;c.beginPath();c.arc(x,y,r,0,Math.PI*2);c.fill()}for(let i=0;i<2e3;i++){c.fillStyle=`rgba(200,195,220,${Math.random()*.04})`;c.fillRect(Math.random()*w,Math.random()*h,1,1)}c.font='300 15px "Cormorant Garamond",serif';c.textAlign='center';c.fillStyle='rgba(200,195,220,.3)';c.fillText('your photo here',w/2,h*.83);c.font='300 10px "Nunito Sans",sans-serif';c.fillText('(tap to see art filters)',w/2,h*.89);return o}
function initP(){const f=document.getElementById('pf'),s=f.offsetWidth||280;pc.width=s;pc.height=s;pctx.drawImage(genP(s,s),0,0);oD=pctx.getImageData(0,0,s,s)}
function apF(n){const w=pc.width,h=pc.height;pctx.putImageData(oD,0,0);if(n==='Original')return;const id=pctx.getImageData(0,0,w,h),d=id.data;
if(n==='Moonlit River'){for(let i=0;i<d.length;i+=4){d[i]=Math.min(255,d[i]*.82+15);d[i+1]=Math.min(255,d[i+1]*.85+18);d[i+2]=Math.min(255,d[i+2]*1.12+22)}pctx.putImageData(id,0,0);const v=pctx.createRadialGradient(w*.6,h*.3,w*.08,w/2,h/2,w*.55);v.addColorStop(0,'rgba(200,195,230,.08)');v.addColorStop(1,'rgba(12,16,30,.12)');pctx.fillStyle=v;pctx.fillRect(0,0,w,h)}
else if(n==='Paper Texture'){for(let i=0;i<d.length;i+=4){d[i]=Math.min(255,d[i]*1.05+18);d[i+1]=Math.min(255,d[i+1]+14);d[i+2]=Math.min(255,d[i+2]+10)}pctx.putImageData(id,0,0);for(let i=0;i<5e3;i++){pctx.fillStyle=`rgba(220,210,200,${Math.random()*.02})`;pctx.fillRect(Math.random()*w,Math.random()*h,1+Math.random()*2,1)}}
else if(n==='Candlelight'){for(let i=0;i<d.length;i+=4){d[i]=Math.min(255,d[i]*1.12+12);d[i+1]=Math.min(255,d[i+1]*1.05+8);d[i+2]=d[i+2]*.85+5}pctx.putImageData(id,0,0);pctx.globalAlpha=.2;for(let i=0;i<5;i++)pctx.drawImage(pc,(Math.random()-.5)*4,(Math.random()-.5)*4);pctx.globalAlpha=1;const v=pctx.createRadialGradient(w/2,h/2,w*.12,w/2,h/2,w*.55);v.addColorStop(0,'rgba(255,220,150,.04)');v.addColorStop(1,'rgba(12,16,30,.12)');pctx.fillStyle=v;pctx.fillRect(0,0,w,h)}
else if(n==='Midnight Silk'){for(let i=0;i<d.length;i+=4){d[i]=Math.min(255,d[i]*.8+8);d[i+1]=Math.min(255,d[i+1]*.82+12);d[i+2]=Math.min(255,d[i+2]*1.05+18)}pctx.putImageData(id,0,0);pctx.globalAlpha=.25;for(let i=0;i<7;i++)pctx.drawImage(pc,(Math.random()-.5)*6,(Math.random()-.5)*6);pctx.globalAlpha=1;pctx.fillStyle='rgba(12,16,30,.1)';pctx.fillRect(0,0,w,h)}}
document.getElementById('pf').addEventListener('click',e=>{cf=(cf+1)%FILTERS.length;pc.style.transition='opacity .3s';pc.style.opacity='.4';setTimeout(()=>{apF(FILTERS[cf]);fl.textContent=FILTERS[cf];pc.style.opacity='1'},250);spB(e.clientX,e.clientY)});
function spB(x,y){for(let i=0;i<2;i++){const b=new PaperBoat(2);b.x=x+(Math.random()-.5)*40;b.y=Math.max(waterY+15,y)+(Math.random()-.5)*20;b.alpha=.3+Math.random()*.2;b.vx=.2+Math.random()*.3;touchBoats.push(b)}}
document.addEventListener('click',e=>{if(e.target.closest('.envelope-screen')||e.target.closest('.photo-frame'))return;spB(e.clientX,e.clientY)});
document.fonts.ready.then(()=>setTimeout(initP,100));addEventListener('resize',()=>{resize();setTimeout(initP,100)});
</script>
</body>
</html>
